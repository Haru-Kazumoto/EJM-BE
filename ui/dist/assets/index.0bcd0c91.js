import{R as F,r as b,a as e,j as h,h as k,am as D,T as I,ap as Q,aq as v,f as R,D as q}from"./index.36e5c8e0.js";import{a as V,P as C}from"./PagePadding.1c9da704.js";import{P as G}from"./PageHeader.f142dabc.js";import{B as J}from"./BeTable.4a5bf216.js";import{U as Y}from"./useTableHelper.198ec7b7.js";import{u as U,F as M,a as w}from"./FormFieldControl.2c89898e.js";import{F as T}from"./FieldCustom.a580ac8f.js";import{j as H,a as W,S as N,k as A}from"./projectActions.d0ab648c.js";import{S as X}from"./SelectCompanies.d508d9bc.js";import{u as O,G as B,b as z,a as E}from"./useSelectDataMapper.533313d1.js";import{u as K}from"./useDebounce.3f476afc.js";import{S as L}from"./select.3b6ee5a4.js";import{F as Z}from"./FilterIcon.742ec280.js";import{d as $}from"./dayjs.min.9509b64d.js";import{B as ee}from"./index.esm.c218bf3a.js";import"./ArrowLeftIcon.59577fdf.js";import"./slicedToArray.69cafb3e.js";import"./index.esm.4c8c0183.js";import"./index.esm.9df59221.js";import"./index.esm.adaa90cb.js";import"./index.esm.0f58bf09.js";import"./index.238261e4.js";import"./ErrorEmpty.98242666.js";import"./Pagination.5a934f43.js";import"./ExpandLeftIcon.05955737.js";import"./ExpandRightIcon.e539ace1.js";import"./useTranslation.7b5c047c.js";import"./SearchInput.7c7deac2.js";import"./companyActions.ce65fea3.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";const re=F.forwardRef(({name:l,onChange:u,onBlur:o,value:n,placeholder:j,watch:g,companyKey:d},_)=>{const[a,x]=b.exports.useState(""),m=K(a,1e3),r=g(d),{fetchNextPage:f,hasNextPage:y,isError:S,isSuccess:t,isLoading:i,data:p,isFetchingNextPage:P}=O(["fetch_select_project_by_company",m,r==null?void 0:r.value],({pageParam:c=1})=>H({current:c,search:m,value:n==null?void 0:n.value,company:r==null?void 0:r.value,pageSize:15}),{enabled:!!(r!=null&&r.value),getNextPageParam:c=>B(c),getPreviousPageParam:c=>z(c)}),s=E({isSuccess:t,data:p!=null?p:{pages:[],pageParams:[]},key:"projects",returnList:c=>({label:c.name,value:c.id})});return e(L,{name:l,ref:_,onChange:u,onBlur:o,value:n,onInputChange:x,isLoading:P||i,isClearable:!0,noOptionsMessage:({inputValue:c})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:c})=>h(k,{children:[h("div",{children:['Mencari "',c,'"']}),i&&e(D,{size:"xs",width:"100%",isIndeterminate:!0}),S&&e("div",{children:"Error saat mencari data"})]}),options:s,placeholder:e(I,{noOfLines:[1],children:j}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{y&&f()},closeMenuOnSelect:!0})}),ae=F.forwardRef(({name:l,onChange:u,onBlur:o,value:n,placeholder:j,watch:g,projectKey:d},_)=>{const[a,x]=b.exports.useState(""),m=K(a,1e3),r=g(d),{fetchNextPage:f,hasNextPage:y,isError:S,isSuccess:t,isLoading:i,data:p}=O(["fetch_select_structure_by_project",m,r==null?void 0:r.value],({pageParam:s=1})=>W({current:s,search:m,value:n==null?void 0:n.value,project:r==null?void 0:r.value,pageSize:15}),{enabled:!!(r!=null&&r.value),refetchOnMount:!1,refetchOnWindowFocus:!1,getNextPageParam:s=>B(s),getPreviousPageParam:s=>z(s)}),P=E({isSuccess:t,data:p!=null?p:{pages:[],pageParams:[]},key:"structures",returnList:s=>({label:s.name,value:s.uuid})});return e(L,{name:l,ref:_,onChange:u,onBlur:o,value:n,onInputChange:x,isLoading:i,isClearable:!0,noOptionsMessage:({inputValue:s})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:s})=>h(k,{children:[h("div",{children:['Mencari "',s,'"']}),i&&e(D,{size:"xs",width:"100%",isIndeterminate:!0}),S&&e("div",{children:"Error saat mencari data"})]}),options:P,placeholder:e(I,{noOfLines:[1],children:j}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{y&&f()},closeMenuOnSelect:!0})}),te=()=>{const{control:l,formState:u,watch:o,setValue:n}=U();return b.exports.useEffect(()=>{n("project",null),n("structures",null)},[o("company")]),b.exports.useEffect(()=>{n("structures",null)},[o("project")]),h(Q,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)",lg:"repeat(4,1fr)"},gap:5,children:[e(v,{children:e(M,{placeholder:"-- Company --",control:l,name:"company",formState:u,label:"Company",id:"company",rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(T,{children:e(X,{})})})}),e(v,{children:e(M,{placeholder:"-- Project --",control:l,name:"project",formState:u,label:"Project",id:"project",watch:o,rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(T,{children:e(re,{companyKey:"company"})})})}),e(v,{children:e(M,{placeholder:"-- Company Structures --",control:l,name:"structures",formState:u,label:"Company Structures",id:"structures",watch:o,rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(T,{children:e(ae,{projectKey:"project"})})})}),e(v,{children:e(M,{placeholder:"-- Pilih Status Pertanyaan --",control:l,name:"project_status",formState:u,label:"Status Pertanyaan",id:"project_status",rules:{required:{value:!1,message:"Dibutuhkan"}},children:e(T,{children:e(N,{type_:"QUESTION_STATUS"})})})}),e(v,{children:e(M,{placeholder:"-- Project Type --",control:l,name:"project_type",formState:u,label:"Project Type",id:"project_type",children:e(T,{children:e(N,{type_:"PROJECT_TYPE"})})})})]})},Be=()=>{var f,y,S;const[l,u]=b.exports.useState({}),[o,n]=b.exports.useState({company:null,project:null,structures:null,project_type:null,project_status:null}),{setPagination:j,searchValue:g,pagination:d,handleSearch:_}=Y(),{data:a,isLoading:x}=R(["report",{searchValue:g,...d,...o}],()=>A({pageSize:d.pageSize,current:d.pageIndex+1,search:g,project_id:o.project,project_type:o.project_type,project_status:o.project_status,company_id:o.company,structure_id:o.structures}),{keepPreviousData:!1}),m=t=>{var i,p,P,s,c;n({structures:(i=t.structures)==null?void 0:i.value,company:(p=t.company)==null?void 0:p.value,project:(P=t.project)==null?void 0:P.value,project_type:(s=t.project_type)==null?void 0:s.value,project_status:(c=t.project_status)==null?void 0:c.value})},r=F.useMemo(()=>[{id:"No",header:"No",accessorFn:(t,i)=>i+1},{id:"Pertanyaan",header:"Pertanyaan",accessorKey:"name"},{id:"Status",header:"Status",accessorKey:"status"},{id:"Jawaban",header:"Jawaban",accessorKey:"full_name"},{id:"Jawaban tambahan",header:"Jawaban tambahan"},{id:"Tanggal Terjawab",header:"Tanggal Terjawab",accessorKey:"answered_at",cell:({row:t})=>{var i;return $((i=t.original)==null?void 0:i.answered_at).format("DD MMMM YYYY")}}],[]);return h(V,{title:"Report Questionaire",children:[e(G,{label:"Report Questionaire"}),e(q,{}),e(C,{x:6,y:6,children:h(w,{onSubmit:m,id:"form-filter-report-questioner",children:[e(te,{}),e(ee,{mt:5,leftIcon:e(Z,{}),type:"submit",children:"Filter"})]})}),e(C,{x:0,y:6,children:e(J,{enableResizeColumn:!1,useSearchInput:!0,loading:x,onSearch:_,rowKey:(t,i,p)=>t==null?void 0:t.id,onChangeTable:j,onCheckboxChange:u,pagination:{pageIndex:Number((f=a==null?void 0:a.page)!=null?f:0)-1,pageSize:Number((y=a==null?void 0:a.page_size)!=null?y:10)},pageCount:Number((S=a==null?void 0:a.page_count)!=null?S:0),rowSelectionProps:l,totalRecords:a==null?void 0:a.total,data:(a==null?void 0:a.projects)||[],columns:r})})]})};export{Be as default};
