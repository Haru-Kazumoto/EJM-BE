import{j as r,I as be,a as e,R as Se,r as L,h as z,an as Ce,T as v,d as F,a4 as H,ac as Z,f as J,B as _,F as m,c as je,aq as K,ar as A,aO as re,aP as ne,aQ as Te,u as Fe,aR as we,aS as Ne,g as pe,aj as me}from"./index.94f4ac20.js";import{a as Oe,P as Qe}from"./PagePadding.6046cab3.js";import{P as Re}from"./PageHeader.36ca4136.js";import{A as ve}from"./AddIcon.d57b60e6.js";import{E as se}from"./EditIcon.574f14a3.js";import{D as w}from"./Detailinformation.91463110.js";import{B as Ve}from"./BuildingIcon.2c6746ac.js";import{C as Be,F as He}from"./FormFieldProject.2cd15a14.js";import{U as qe}from"./UserIcon.bd972666.js";import{d as ie}from"./dayjs.min.eb8ec5a4.js";import{r as $e}from"./relativeTime.84b39508.js";import{D as _e}from"./DeleteIcon.33d0d750.js";import{E as Ge}from"./EyeIcon.682c212e.js";import{c as T,o as Q,a as Pe}from"./uiActions.e41b0bc7.js";import{S as X}from"./SearchInput.0240a11f.js";import{a as oe,S as We,u as Ye,b as Je,d as Ke,c as Ze,e as Xe,s as et,f as tt,h as rt,i as nt,j as it}from"./projectActions.891fa5d9.js";import{u as V}from"./useDebounce.8dc04551.js";import{u as q,a as $}from"./useSelectDataMapper.34094058.js";import{C as ye}from"./ConfirmDelete.509fe91e.js";import{u as st,F as he,a as ae}from"./FormFieldControl.4d0de4ad.js";import{G as ke,a as xe}from"./useGetPrevPageParam.cb1386c2.js";import{S as Ie}from"./select.91f1883c.js";import{F as ge}from"./FieldCustom.e855dee4.js";import{S as Ae}from"./SaveIcon.2e65ab00.js";import{u as R,E as O}from"./useError.75f3b100.js";import{f as ee}from"./index.esm.4627e16a.js";import{B as E,I as U}from"./index.esm.634a2674.js";import{A as te,a as ot}from"./index.esm.034b4c15.js";import{C as le,c as ce,a as de}from"./index.esm.504dbc4c.js";import{T as N}from"./index.esm.be8d468a.js";import{E as Le}from"./ErrorFetching.534bb345.js";import{E as B}from"./ErrorEmpty.f38b7362.js";import{a as at,C as ue}from"./index.esm.67abfb3f.js";import{F as lt,a as ct,I as dt,c as ut,f as pt,g as mt}from"./index.esm.ad9c0ced.js";import{g as ht}from"./questionActions.644e3006.js";import{S as De}from"./index.esm.ee67b074.js";import{e as gt}from"./usersActions.1d956ca8.js";import{T as ft,a as bt,b as G,c as St,d as W}from"./index.esm.3fa5a679.js";import"./ArrowLeftIcon.479df347.js";import"./FieldText.54672b0b.js";import"./slicedToArray.893d443e.js";import"./FieldTextArea.f8790873.js";import"./useTranslation.ea7253ab.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./index.esm.12b0699d.js";import"./index.esm.ec4e0a7f.js";import"./inheritsLoose.0362d3f0.js";import"./index.238261e4.js";const Y=({...t})=>r(be,{...t,children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 5C3 4.44772 3.44772 4 4 4H16C16.5523 4 17 4.44772 17 5C17 5.55228 16.5523 6 16 6H4C3.44772 6 3 5.55228 3 5Z",fill:"currentColor"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 10C3 9.44772 3.44772 9 4 9H16C16.5523 9 17 9.44772 17 10C17 10.5523 16.5523 11 16 11H4C3.44772 11 3 10.5523 3 10Z",fill:"currentColor"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 15C9 14.4477 9.44772 14 10 14H16C16.5523 14 17 14.4477 17 15C17 15.5523 16.5523 16 16 16H10C9.44772 16 9 15.5523 9 15Z",fill:"currentColor"})]}),Ct=Se.forwardRef(({name:t,onChange:l,onBlur:o,value:i,placeholder:d,projectId:h,isMulti:S=!1},g)=>{const[u,p]=L.exports.useState(""),j=V(u,1e3),{fetchNextPage:b,hasNextPage:C,isError:P,isSuccess:n,isLoading:y,data:k}=q(["fetch_select_structure_by_project_primitive",j,h],({pageParam:c=1})=>oe({current:c,search:j,value:i==null?void 0:i.value,project:+h,pageSize:15}),{enabled:!!h,refetchOnMount:!1,refetchOnWindowFocus:!1,getNextPageParam:c=>ke(c),getPreviousPageParam:c=>xe(c)}),I=$({isSuccess:n,data:k!=null?k:{pages:[],pageParams:[]},key:"structures",returnList:c=>({label:c.name,value:c.uuid})});return e(Ie,{name:t,ref:g,onChange:l,onBlur:o,value:i,isMulti:S,onInputChange:p,isLoading:y,isClearable:!0,noOptionsMessage:({inputValue:c})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:c})=>r(z,{children:[r("div",{children:['Mencari "',c,'"']}),y&&e(Ce,{size:"xs",width:"100%",isIndeterminate:!0}),P&&e("div",{children:"Error saat mencari data"})]}),options:I,placeholder:e(v,{noOfLines:[1],children:d}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{C&&b()},closeMenuOnSelect:!0})}),Ee=({project_id:t})=>{const{control:l,formState:o}=st();return r(z,{children:[e(he,{control:l,name:"job",formState:o,id:"job",placeholder:"-- Pilih Pekerjaan --",rules:{required:{value:!0,message:"Dibutuhkan"},min:{value:1,message:"Dibutuhkan"}},children:e(ge,{children:e(We,{type_:"PROJECT_JOB",isMulti:!0})})}),e(he,{control:l,name:"unit_kerja",formState:o,id:"unit_kerja",placeholder:"-- Pilih Unit Kerja --",rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(ge,{children:e(Ct,{projectId:t,isMulti:!0})})})]})},jt=({project_id:t,user_id:l})=>{const o=F(),i=H(),d=Z(),h=R(Ye),{data:S,isLoading:g,isError:u,isSuccess:p}=J(["detail_assigned_user",t,l],()=>Je({projectId:t,userId:l}),{enabled:!!t&&!!l,cacheTime:0,onError:b=>O(b,i)});return r(z,{children:[u&&e(_,{p:5,children:"Error"}),g&&e(_,{p:5,children:"Loading..."}),p&&r(ae,{onSubmit:b=>{const C=b.job.map(n=>n.value),P=b.unit_kerja.map(n=>n.value);h.mutate({userId:l,payload:{project_id:+t,job:C,structure_id:P}},{onSuccess:n=>{i({status:"success",title:"success",description:n.message,position:"top",isClosable:!0}),d.invalidateQueries(["project_detail"]),d.invalidateQueries(["users_assigned"]),o(T())},onError:n=>O(n,i)})},id:"form-edit-assign-user",initialValues:{job:S.data.job,unit_kerja:S.data.structures},children:[e(_,{p:5,children:e(m,{gap:5,flexDirection:"column",children:e(Ee,{project_id:t})})}),e(ee,{children:r(m,{gap:5,children:[e(E,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>o(T()),children:"Cancel"}),e(E,{type:"submit",variant:"solid",isLoading:h.isLoading,size:"sm",leftIcon:e(Ae,{}),children:"Submit"})]})})]})]})},Me=({project_id:t})=>{const[l,o]=L.exports.useState();je();const i=F(),d=H(),h=Z(),S=V(l,200),g=R(Ke),{data:u,isLoading:p,isSuccess:j,isError:b,isFetchingNextPage:C,hasNextPage:P,fetchNextPage:n}=q(["assign_users_paginated",S,t],({pageParam:s})=>Ze({pageSize:20,current:s,search:S,project_id:t})),y=s=>{g.mutate({id:s,projectId:+t},{onSuccess:x=>{d({status:"success",title:"Sukses",description:x.message,position:"top",isClosable:!0}),h.invalidateQueries(["project_detail"]),h.invalidateQueries(["users_assigned"]),i(T())},onError:x=>O(x,d)})},k=s=>{i(Q(e(ye,{onDelete:()=>y(s)}),"Anda yakin ingin menghapus data ini ?","md"))},I=s=>{i(Q(e(jt,{project_id:t,user_id:s}),"Edit User","md"))},c=$({isSuccess:j,data:u!=null?u:{pages:[],pageParams:[]},key:"users",filterFn:s=>s.roleId!==1,returnList:s=>{var x,D;return r(m,{justifyContent:"space-between",alignItems:"center",children:[r(m,{gap:2,alignItems:"center",children:[e(te,{size:"xs",objectFit:"cover",name:(x=s.full_name)!=null?x:"",src:s.profile_pict?`/api/v1/profiles/${s.profile_pict}`:"/default-image.jpg"}),e(v,{fontSize:"sm",children:(D=s.full_name)!=null?D:""})]}),r(_,{children:[e(U,{"aria-label":"Edit Assigned User",fontSize:20,color:"yellow.500",variant:"link",onClick:()=>I(s.id),icon:e(se,{})}),e(U,{"aria-label":"Delete Assigned User",fontSize:20,color:"red.500",variant:"link",onClick:()=>k(s.id),icon:e(_e,{})})]})]})}});return e(_,{p:5,children:r(m,{flexDirection:"column",gap:5,children:[e(X,{onChange:s=>{s.preventDefault(),o(s.target.value)}}),b&&"Error Occured",p&&"Loading..",j&&r(m,{flexDirection:"column",gap:2,maxH:300,overflowY:"auto",children:[c,P&&e(E,{size:"sm",mt:2,onClick:()=>n(),isLoading:C,children:"Load More"})]})]})})};ie.extend($e);const vt=({data:t,onDelete:l,onEdit:o})=>{const i=F(),d=()=>{i(Pe({component:e(Me,{project_id:t.id}),title:"List Assigned User",size:"md"}))};return r(le,{children:[e(ce,{children:r(m,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{fontWeight:"medium",fontSize:19,children:"Project Info"}),r(m,{alignItems:"center",gap:2,children:[e(N,{label:"Edit Project Info",children:e(U,{"aria-label":"Edit",variant:"unstyled",onClick:o,icon:e(se,{fontSize:28,color:"yellow.400"})})}),e(N,{label:"Delete Project",children:e(U,{"aria-label":"Delete",variant:"unstyled",onClick:l,icon:e(_e,{fontSize:28,color:"red.400"})})})]})]})}),e(de,{children:r(K,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)",xl:"repeat(3,1fr)"},gap:{base:5,md:2},children:[e(A,{children:e(w,{leftIcon:e(Ve,{fontSize:21}),label:"Company",value:r(m,{gap:2,alignItems:"center",children:[e(te,{size:"xs",objectFit:"cover",name:t.company.name,src:t.company.profile_pict?`/api/v1/profiles/${t.company.profile_pict}`:"/default-image.jpg"}),e(v,{fontSize:12,children:t.company.name})]}),direction:"column"})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Type",direction:"column",value:t.select_project_type_label})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Status",direction:"column",value:t.select_status_label})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Code",direction:"column",value:t.project_code})}),e(A,{children:e(w,{leftIcon:e(Be,{fontSize:21}),label:"Due Date",direction:"column",value:r("div",{children:[e(v,{children:ie(t.project_date).format("DD MMMM YYYY")}),r("small",{children:["(",ie(t.project_date).fromNow(),")"]})]})})}),e(A,{children:e(w,{leftIcon:e(qe,{fontSize:21}),label:"Assigned User",direction:"column",value:r(m,{gap:2,alignItems:"center",children:[e(v,{children:t.total_assigned_users.toString()}),e(N,{label:"Click to view Detail",children:e(U,{"aria-label":"Detail",variant:"link",onClick:d,icon:e(Ge,{})})})]})})}),e(A,{colSpan:{base:0,xl:3},children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Description",direction:"column",value:t.description})})]})})]})},_t=()=>r(le,{children:[e(ce,{children:e(v,{fontWeight:"medium",fontSize:19,children:"Task Progress"})}),e(de,{children:r(K,{templateColumns:{base:"repeat(1,1fr)",xl:"repeat(3,1fr)"},gap:5,children:[e(A,{children:r(m,{flexDirection:"column",alignItems:"center",children:[r("div",{style:{marginBottom:2},children:[e(v,{children:"Questionaire"}),e("small",{children:"( 10 / 210 )"})]}),e(_,{children:e(re,{value:40,color:"green.400",size:150,children:e(ne,{children:"40%"})})})]})}),e(A,{children:r(m,{flexDirection:"column",alignItems:"center",children:[r("div",{style:{marginBottom:2},children:[e(v,{children:"Inventory"}),e("small",{children:"( 10 / 50 )"})]}),e(_,{children:e(re,{value:20,color:"green.400",size:150,children:e(ne,{children:"20%"})})})]})}),e(A,{children:r(m,{flexDirection:"column",alignItems:"center",children:[r("div",{style:{marginBottom:2},children:[e(v,{children:"Volumes"}),e("small",{children:"( 5 / 10 )"})]}),e(_,{children:e(re,{value:10,color:"green.400",size:150,children:e(ne,{children:"10%"})})})]})})]})})]}),ze=(t="id",l="parentId",o,i="0")=>o.filter(d=>d[l]===i).map(d=>({...d,children:ze(t,l,o,d[t])})),Ue=({id:t,placeholder:l,label:o,isRequired:i=!1,errorMessage:d,type:h="text",leftElement:S,rightElement:g,isInvalid:u=!1,formState:p,direction:j="row",options:b,...C})=>r(lt,{isRequired:i,isInvalid:u,children:[o&&o!==""?e(ct,{htmlFor:t,children:o}):null,r(dt,{children:[S&&e(ut,{pointerEvents:"none",alignItems:"center",children:S}),e(at,{...C,children:e(Te,{direction:j,children:b&&b.length>0?b.map(P=>e(ue,{value:P.value,children:P.label})):null})}),g&&e(pt,{alignItems:"center",children:g})]}),e(mt,{children:d})]}),Pt=Se.forwardRef(({name:t,onChange:l,onBlur:o,value:i,placeholder:d,isMulti:h=!1},S)=>{const[g,u]=L.exports.useState(""),p=V(g,1e3),{fetchNextPage:j,hasNextPage:b,isError:C,isSuccess:P,isLoading:n,data:y,isFetchingNextPage:k}=q(["fetch_select_question_templates",p],({pageParam:c=1})=>ht({current:c,search:p,value:i==null?void 0:i.value,using_active:!0,pageSize:15}),{getNextPageParam:c=>ke(c),getPreviousPageParam:c=>xe(c)}),I=$({isSuccess:P,data:y!=null?y:{pages:[],pageParams:[]},key:"question_templates",returnList:c=>({label:c.name,value:c.id})});return e(Ie,{name:t,ref:S,onChange:l,onBlur:o,isMulti:h,value:i,onInputChange:u,isLoading:k||n,isClearable:!0,noOptionsMessage:({inputValue:c})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:c})=>r(z,{children:[r("div",{children:['Mencari "',c,'"']}),n&&e(Ce,{size:"xs",width:"100%",isIndeterminate:!0}),C&&e("div",{children:"Error saat mencari data"})]}),options:I,placeholder:d,closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{b&&j()},closeMenuOnSelect:!0})}),yt=({projectId:t})=>{const[l,o]=L.exports.useState(),[i,d]=L.exports.useState([]),[h,S]=L.exports.useState(null),g=H(),u=F(),p=V(l,200),j=R(Xe),b=Z(),{data:C,isLoading:P,isSuccess:n,isError:y,hasNextPage:k,fetchNextPage:I}=q(["assign_project_structures",t,p],({pageParam:f})=>oe({pageSize:20,current:f,search:p,project:+t}),{enabled:!!t}),c=$({isSuccess:n,data:C!=null?C:{pages:[],pageParams:[]},key:"structures",returnList:f=>({label:`${f.structureCode} - ${f.name}`,value:JSON.stringify(f)})}),s=f=>{d(f?["all"]:[])},x=f=>{S(f)},D=()=>{let f=[];i.includes("all")?f=["all"]:i.map(a=>{f.push(JSON.parse(a).uuid)}),h.length<1?g({status:"warning",description:"Wajib pilih template",position:"top",title:"Validasi",isClosable:!0}):j.mutate({project_id:+t,question_template_id:h.map(a=>a.value),structure_ids:f},{onSuccess:a=>{g({status:"success",description:a.message,position:"top",title:"Success",isClosable:!0}),b.invalidateQueries(["project_structures"]),u(T())},onError:a=>O(a,g)})};return r(_,{p:5,children:[r(m,{flexDirection:"column",gap:5,children:[e(Pt,{placeholder:"-- Pilih Template --",isMulti:!0,value:h,onChange:x}),e(X,{onChange:f=>{f.preventDefault(),o(f.target.value)}}),e(ue,{value:"all",onChange:f=>s(f.target.checked),children:"Semua"}),i&&i.length>0&&!i.includes("all")&&e(_,{children:r(m,{gap:3,alignItems:"center",children:[r(v,{fontSize:"sm",children:["Terpilih ",i.length," Unit "]}),e(E,{variant:"link",colorScheme:"red",size:"sm",onClick:()=>d([]),children:"Hapus Pilihan"})]})}),r(_,{maxH:500,overflowY:"auto",children:[P&&e(De,{w:"100%",h:20}),y&&e(v,{children:"Error"}),n&&!i.includes("all")&&e(Ue,{options:c,direction:"column",value:i,disabled:i.includes("all"),onChange:d})]}),k&&e(m,{justifyContent:"center",w:"100%",children:e(E,{size:"sm",onClick:()=>I(),children:"Load More"})})]}),e(ee,{children:e(E,{variant:"solid",onClick:D,isLoading:j.isLoading,children:"Simpan"})})]})},fe=({...t})=>r(be,{...t,children:[e("path",{d:"M2 14L5.23309 16.4248C5.66178 16.7463 6.26772 16.6728 6.60705 16.2581L15 6",stroke:"currentColor",strokeWidth:"2",fill:"transparent",strokeLinecap:"round"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.87451 15.7801L11.6031 17.163C12.4589 17.8477 13.7064 17.716 14.4004 16.8677L22.7741 6.63324C23.1238 6.20579 23.0608 5.57577 22.6333 5.22604C22.2059 4.87631 21.5759 4.93932 21.2262 5.36676L12.8525 15.6013L11.1411 14.2321L9.87451 15.7801Z",fill:"currentColor"})]}),kt=({projectId:t,active:l,onClick:o})=>{const[i,d]=L.exports.useState(null),{colorMode:h}=Fe(),S=F(),g=V(i,100),{data:u,isLoading:p,isSuccess:j,isError:b}=J(["project_structures",t,g],()=>oe({pageSize:100,current:1,search:g,project:+t}),{enabled:!!t}),C=L.exports.useCallback((n,y=0)=>{var k,I,c;return(n==null?void 0:n.children)&&((k=n==null?void 0:n.children)==null?void 0:k.length)>0?r(_,{position:"relative",children:[e(N,{label:n.name,children:r(m,{py:1,px:2,my:2,cursor:"pointer",justifyContent:"space-between",borderRadius:15,alignItems:"center",_hover:{backgroundColor:"rgba(104,211,145,0.35)"},backgroundColor:l===n.uuid?"rgba(104,211,145,0.35)":"none",onClick:()=>{o(n.uuid)},children:[r(v,{noOfLines:[1],children:[n.structureCode," - ",n.name]}),e(fe,{color:n.total_questions>0&&"brand.light"})]})}),e(_,{sx:{ml:5},children:(I=n==null?void 0:n.children)==null?void 0:I.map(s=>C(s,y+1))}),e(_,{width:.5,height:`calc(100% - ${((c=n==null?void 0:n.children)==null?void 0:c.length)+38}px)`,bg:h==="light"?"black":"white",position:"absolute",left:3,top:9})]}):e(N,{label:n.name,children:r(m,{py:1,my:2,px:2,_hover:{backgroundColor:"rgba(104,211,145,0.35)"},backgroundColor:l===n.uuid?"rgba(104,211,145,0.35)":"none",cursor:"pointer",onClick:()=>o(n.uuid),gap:5,alignItems:"center",borderRadius:15,children:[r(v,{noOfLines:[1],children:[n.structureCode," - ",n.name]}),e(fe,{color:n.total_questions>0&&"brand.light"})]})})},[l,h]);return r(le,{children:[r(ce,{children:[r(m,{justifyContent:"space-between",alignItems:"center",children:[e(v,{fontWeight:"medium",fontSize:19,children:"Unit Kerja"}),e(N,{label:"Atur Template",children:e(U,{"aria-label":"Add Questioner",onClick:()=>{S(Q(e(yt,{projectId:t}),"Atur Template Pertanyaan per Unit kerja","lg"))},icon:e(ve,{}),variant:"outline",border:"none"})})]}),e("small",{children:"Centang dua hijau : sudah diatur pertanyaan"})]}),r(de,{children:[e(X,{onChange:n=>{n.preventDefault(),d(n.target.value)}}),r(_,{mt:3,children:[b&&e(Le,{}),p&&"Loading...",j&&(u==null?void 0:u.structures)&&(u==null?void 0:u.structures.length)>0?g===""||!g?ze("uuid","parent_id",u==null?void 0:u.structures).map(n=>C(n,0)):u==null?void 0:u.structures.map(n=>C(n,0)):e(B,{})]})]})]})},xt=({initialValues:t={project_description:null,project_name:null,project_status:null,project_code:null,project_type:null,project_due_date:null},isLoading:l=!1,onSubmit:o})=>{const i=F();return r(ae,{initialValues:t,onSubmit:o,id:"form-project-info",children:[e(_,{p:5,children:e(He,{disabled:{project_type:!0}})}),e(ee,{children:r(m,{alignItems:"center",gap:5,children:[e(E,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>i(T()),children:"Cancel"}),e(E,{type:"submit",variant:"solid",isLoading:l,size:"sm",leftIcon:e(Ae,{}),children:"Submit"})]})})]})},It=({projectId:t})=>{const[l,o]=L.exports.useState(),[i,d]=L.exports.useState([]),h=H(),S=Z(),g=F(),u=V(l,200),p=R(et),{data:j,isLoading:b,isSuccess:C,isError:P,hasNextPage:n,fetchNextPage:y}=q(["assign_users",u,t],({pageParam:s})=>tt({pageSize:20,current:s,search:u,project_id:t})),k=$({isSuccess:C,data:j!=null?j:{pages:[],pageParams:[]},key:"users",filterFn:s=>s.roleId!==1,returnList:s=>{var x,D;return{label:r(m,{gap:2,alignItems:"center",children:[e(te,{size:"xs",objectFit:"cover",name:(x=s.full_name)!=null?x:"",src:s.profile_pict?`/api/v1/profiles/${s.profile_pict}`:"/default-image.jpg"}),e(v,{fontSize:"sm",children:(D=s.full_name)!=null?D:""})]}),value:JSON.stringify(s)}}}),I=s=>{d(s?["all"]:[])};return r(ae,{onSubmit:s=>{const x=s.job.map(a=>a.value),D=s.unit_kerja.map(a=>a.value);let f=[];i.includes("all")?f=["all"]:i.map(a=>{f.push(String(JSON.parse(a).id))}),p.mutate({project_id:+t,job:x,structure_id:D,users:f},{onSuccess:a=>{h({status:"success",title:"success",description:a.message,position:"top",isClosable:!0}),S.invalidateQueries(["project_detail"]),S.invalidateQueries(["users_assigned"]),g(T())},onError:a=>O(a,h)})},id:"form-assign",children:[e(_,{p:5,children:r(m,{flexDirection:"column",gap:5,children:[e(Ee,{project_id:t}),e(X,{onChange:s=>{s.preventDefault(),o(s.target.value)}}),e(ue,{value:"all",onChange:s=>I(s.target.checked),children:"Semua"}),i&&i.length>0&&!i.includes("all")&&e(z,{children:e(_,{children:r(m,{gap:3,alignItems:"center",children:[r(v,{fontSize:"sm",children:["Terpilih ",i.length," User "]}),e(E,{variant:"link",colorScheme:"red",size:"sm",onClick:()=>d([]),children:"Hapus Pilihan"})]})})}),r(_,{maxH:500,overflowY:"auto",children:[b&&e(De,{w:"100%",h:20}),P&&e(v,{children:"Error"}),C&&!i.includes("all")&&e(Ue,{options:k,direction:"column",value:i,disabled:i.includes("all"),onChange:d})]}),n&&e(m,{justifyContent:"center",w:"100%",children:e(E,{size:"sm",onClick:()=>y(),isLoading:b,children:"Load More"})})]})}),e(ee,{children:e(E,{type:"submit",isLoading:p.isLoading,children:"Simpan"})})]})},At=L.exports.lazy(()=>we(()=>import("./Questionaire.bb610304.js"),["assets/Questionaire.bb610304.js","assets/index.94f4ac20.js","assets/index.65707869.css","assets/PagePadding.6046cab3.js","assets/Detailinformation.91463110.js","assets/CommentsIcon.55388836.js","assets/FileIcon.a11d0540.js","assets/dayjs.min.eb8ec5a4.js","assets/relativeTime.84b39508.js","assets/index.esm.034b4c15.js","assets/index.esm.be8d468a.js","assets/slicedToArray.893d443e.js","assets/index.esm.634a2674.js","assets/EditIcon.574f14a3.js","assets/FormFieldControl.4d0de4ad.js","assets/index.esm.ad9c0ced.js","assets/index.238261e4.js","assets/FieldTextArea.f8790873.js","assets/index.esm.504dbc4c.js","assets/FieldText.54672b0b.js","assets/FieldCustom.e855dee4.js","assets/useGetPrevPageParam.cb1386c2.js","assets/useDebounce.8dc04551.js","assets/useSelectDataMapper.34094058.js","assets/usersActions.1d956ca8.js","assets/select.91f1883c.js","assets/objectWithoutPropertiesLoose.2d2ba74a.js","assets/index.esm.12b0699d.js","assets/index.esm.ec4e0a7f.js","assets/projectActions.891fa5d9.js","assets/FilterIcon.76553eaa.js","assets/ErrorFetching.534bb345.js","assets/useTranslation.ea7253ab.js","assets/useError.75f3b100.js","assets/ArrowLeftIcon.479df347.js","assets/questionActions.644e3006.js","assets/ErrorEmpty.f38b7362.js","assets/uiActions.e41b0bc7.js","assets/index.esm.4627e16a.js","assets/inheritsLoose.0362d3f0.js","assets/index.esm.ee67b074.js"])),Pr=()=>{const{id:t}=Ne(),l=H(),o=F(),i=je(),[d,h]=L.exports.useState(null),S=L.exports.useRef(null),g=R(rt),u=R(nt),{data:p,isLoading:j,isSuccess:b,isError:C,refetch:P}=J(["project_detail",t],()=>it(+t),{enabled:!!t}),{data:n,isSuccess:y}=J(["users_assigned",t],()=>gt(t),{enabled:!!t}),k=a=>{u.mutate(a,{onSuccess:M=>{l({status:"success",title:"Success",isClosable:!0,description:M.message,position:"top"}),o(T()),i("/activity/projects")},onError:M=>O(M,l)})},I=a=>{o(Q(e(ye,{onDelete:()=>k(a)}),"Apakah kamu yakin ingin menghapus project ini ?","sm"))},c=a=>{g.mutate({id:t,payload:{project_code:a.project_code,project_description:a.project_description,project_due_date:a.project_due_date,project_name:a.project_name,project_status:a.project_status.value,project_type:a.project_type.value}},{onSuccess:M=>{l({status:"success",title:"Success",description:M.message,position:"top",isClosable:!0}),o(T()),P()},onError:M=>O(M,l)})},s=()=>{o(Q(e(xt,{onSubmit:c,isLoading:g.isLoading,initialValues:{project_description:p.data.description,project_name:p.data.name,project_status:{label:p.data.select_status_label,value:p.data.status},project_code:p.data.project_code,project_type:{label:p.data.select_project_type_label,value:p.data.type},project_due_date:new Date(p.data.project_date)}}),"Edit Project","lg"))},x=a=>{var M;h(a),(M=S.current)==null||M.removeFilterQuestions()},D=()=>{o(Q(e(It,{projectId:t}),"Atur User per Unit Kerja","md"))},f=()=>{o(Pe({component:e(Me,{project_id:t}),title:"List Assigned User",size:"md"}))};return r(Oe,{title:"Detail Projek ",children:[j&&e(pe,{}),b&&r(z,{children:[e(Re,{label:p.data.name,size:{base:"xs",sm:"md",md:"lg"},useBackButton:!0,additional:r(m,{alignItems:"center",gap:2,children:[e(me,{variant:"subtle",colorScheme:"blue",children:p.data.type}),e(me,{variant:"subtle",colorScheme:"green",children:p.data.status})]})}),r(Qe,{x:6,children:[r(K,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)"},gap:5,mb:5,children:[e(A,{children:e(vt,{data:p.data,onEdit:s,onDelete:()=>I(+t)})}),e(A,{children:e(_t,{})})]}),r(K,{templateColumns:"repeat(6,1fr)",gap:5,children:[e(A,{colSpan:{base:6,lg:6,xl:2},children:e(kt,{projectId:t,onClick:a=>x(a),active:d})}),r(A,{colSpan:{base:6,lg:6,xl:4},children:[r(m,{alignItems:"center",gap:2,children:[e(v,{fontWeight:"semibold",children:"Assigned User"}),e(U,{"aria-label":"Add Assigned User",fontSize:26,onClick:D,variant:"outline",borderRadius:50,icon:e(ve,{})}),y&&e(z,{children:n.data&&n.data.length>0&&r(z,{children:[e(ot,{size:"md",max:2,children:n.data.map(a=>e(te,{name:a.full_name,src:a.profile_pict?`/api/v1/profiles/${a.profile_pict}`:"/default-image.jpg"}))}),e(N,{label:"Edit Assigned Users",children:e(U,{"aria-label":"Edit Assigned User",fontSize:26,color:"yellow.500",variant:"link",onClick:f,icon:e(se,{})})})]})})]}),r(ft,{children:[r(bt,{overflowX:"auto",overflowY:"hidden",children:[e(G,{children:"Questioner"}),e(G,{children:"Inventory"}),e(G,{children:"Volume"}),e(G,{children:"Log Activity"})]}),r(St,{children:[e(W,{p:0,children:d?e(L.exports.Suspense,{fallback:e(pe,{}),children:e(At,{ref:S,structuresId:d,projectId:+t,editable:!0})}):e(B,{})}),e(W,{children:e(B,{})}),e(W,{children:e(B,{})}),e(W,{children:e(B,{})})]})]})]})]})]})]}),C&&e(Le,{})]})};export{Pr as default};
