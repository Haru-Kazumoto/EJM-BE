import{z as Ke,G as Ie,r as _,R as ne,H as le,E as $e,X as Xe,a as r,ao as Ye,j as S,B as de,T as j,F as H,D as Pe,aR as Je,ar as B,aq as he,h as pe,an as Ze,b1 as et,aO as Te,b2 as tt,d as qe,a4 as Le,ae as nt,aL as ot,f as we,g as rt}from"./index.4df5dae3.js";import{i as at,F as it,a as st,I as lt,c as ct,f as ut,g as dt,P as ce}from"./PagePadding.8c1b0086.js";import{D as ae}from"./Detailinformation.1cb8321f.js";import{C as ht}from"./CommentsIcon.804457ce.js";import{F as pt}from"./FileIcon.a3943f0b.js";import{d as ze}from"./dayjs.min.5d3dab01.js";import{r as ft}from"./relativeTime.178d0d32.js";import{A as mt}from"./index.esm.4a036cc6.js";import{T as ie}from"./index.esm.2ca9b441.js";import{E as ge}from"./EditIcon.3ffc7b25.js";import{u as _e,F as Z,a as xe}from"./FormFieldControl.b614070a.js";import{m as vt,I as ue,B as oe}from"./index.esm.780dcd2c.js";import{t as gt}from"./index.238261e4.js";import{F as fe}from"./FieldTextArea.823a0dbf.js";import{c as yt,C as ye,a as Oe}from"./index.esm.a501b0bf.js";import{F as Ae}from"./FieldText.6d44809e.js";import{F as Se}from"./FieldCustom.5b6685a5.js";import{G as Ne,a as We}from"./useGetPrevPageParam.cb1386c2.js";import{u as _t}from"./useDebounce.b8118708.js";import{u as je,a as xt}from"./useSelectDataMapper.6391f061.js";import{b as bt}from"./usersActions.d0e9b122.js";import{S as Ct}from"./select.0fe29549.js";import{S as Pt,l as wt,m as St,n as kt,o as Et}from"./projectActions.f553fa80.js";import{F as Dt}from"./FilterIcon.698af641.js";import{E as Ft}from"./ErrorFetching.5d5f8a6b.js";import{u as Be,E as Ue}from"./useError.46aba7e3.js";import{A as Mt}from"./ArrowLeftIcon.0c9057ff.js";import{f as Rt}from"./questionActions.1a7d06af.js";import{E as ke}from"./ErrorEmpty.d1acacce.js";import{c as Ee,o as It}from"./uiActions.0615ad97.js";import{p as Tt}from"./Page.ce903aa1.js";import{f as qt}from"./index.esm.b22a74c4.js";import{S as Lt}from"./index.esm.f60c0a2c.js";import"./slicedToArray.556cd5c1.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./index.esm.f3b9d19a.js";import"./useTranslation.d56b7bba.js";import"./inheritsLoose.cba8c0e3.js";var zt=(...e)=>e.filter(Boolean).join(" ");function De(e){const o=typeof e;return e!=null&&(o==="object"||o==="function")&&!Array.isArray(e)}var A=e=>e?"":void 0,me=e=>e?!0:void 0;function G(...e){return function(t){e.some(n=>(n==null||n(t),t==null?void 0:t.defaultPrevented))}}function Ot(...e){return function(t){e.forEach(n=>{n==null||n(t)})}}function At(e,o){const t={},n={};for(const[a,i]of Object.entries(e))o.includes(a)?t[a]=i:n[a]=i;return[t,n]}function Nt(e){return e&&De(e)&&De(e.target)}function Wt(e={}){const{onChange:o,value:t,defaultValue:n,name:a,isDisabled:i,isFocusable:l,isNative:c,...d}=e,[u,s]=_.exports.useState(n||""),h=typeof t<"u",m=h?t:u,v=_.exports.useRef(null),x=_.exports.useCallback(()=>{const k=v.current;if(!k)return;let M="input:not(:disabled):checked";const N=k.querySelector(M);if(N){N.focus();return}M="input:not(:disabled)";const I=k.querySelector(M);I==null||I.focus()},[]),y=`radio-${_.exports.useId()}`,f=a||y,R=_.exports.useCallback(k=>{const M=Nt(k)?k.target.value:k;h||s(M),o==null||o(String(M))},[o,h]),z=_.exports.useCallback((k={},M=null)=>({...k,ref:vt(M,v),role:"radiogroup"}),[]),q=_.exports.useCallback((k={},M=null)=>({...k,ref:M,name:f,[c?"checked":"isChecked"]:m!=null?k.value===m:void 0,onChange(I){R(I)},"data-radiogroup":!0}),[c,f,R,m]);return{getRootProps:z,getRadioProps:q,name:f,ref:v,focus:x,setValue:s,value:m,onChange:R,isDisabled:i,isFocusable:l,htmlProps:d}}var[jt,Qe]=Ke({name:"RadioGroupContext",strict:!1}),Ge=Ie((e,o)=>{const{colorScheme:t,size:n,variant:a,children:i,className:l,isDisabled:c,isFocusable:d,...u}=e,{value:s,onChange:h,getRootProps:m,name:v,htmlProps:x}=Wt(u),b=_.exports.useMemo(()=>({name:v,size:n,onChange:h,colorScheme:t,value:s,variant:a,isDisabled:c,isFocusable:d}),[v,n,h,t,s,a,c,d]);return ne.createElement(jt,{value:b},ne.createElement(le.div,{...m(x,o),className:zt("chakra-radio-group",l)},i))});Ge.displayName="RadioGroup";var Bt={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function Ut(e={}){const{defaultChecked:o,isChecked:t,isFocusable:n,isDisabled:a,isReadOnly:i,isRequired:l,onChange:c,isInvalid:d,name:u,value:s,id:h,"data-radiogroup":m,"aria-describedby":v,...x}=e,b=`radio-${_.exports.useId()}`,y=at(),R=!!Qe()||!!m;let q=!!y&&!R?y.id:b;q=h!=null?h:q;const k=a!=null?a:y==null?void 0:y.isDisabled,M=i!=null?i:y==null?void 0:y.isReadOnly,N=l!=null?l:y==null?void 0:y.isRequired,I=d!=null?d:y==null?void 0:y.isInvalid,[P,g]=_.exports.useState(!1),[w,E]=_.exports.useState(!1),[p,V]=_.exports.useState(!1),[Y,U]=_.exports.useState(!1),[J,T]=_.exports.useState(Boolean(o)),O=typeof t<"u",W=O?t:J;_.exports.useEffect(()=>gt(g),[]);const Q=_.exports.useCallback(F=>{if(M||k){F.preventDefault();return}O||T(F.target.checked),c==null||c(F)},[O,k,M,c]),K=_.exports.useCallback(F=>{F.key===" "&&U(!0)},[U]),re=_.exports.useCallback(F=>{F.key===" "&&U(!1)},[U]),C=_.exports.useCallback((F={},ee=null)=>({...F,ref:ee,"data-active":A(Y),"data-hover":A(p),"data-disabled":A(k),"data-invalid":A(I),"data-checked":A(W),"data-focus":A(w),"data-focus-visible":A(w&&P),"data-readonly":A(M),"aria-hidden":!0,onMouseDown:G(F.onMouseDown,()=>U(!0)),onMouseUp:G(F.onMouseUp,()=>U(!1)),onMouseEnter:G(F.onMouseEnter,()=>V(!0)),onMouseLeave:G(F.onMouseLeave,()=>V(!1))}),[Y,p,k,I,W,w,M,P]),{onFocus:L,onBlur:$}=y!=null?y:{},se=_.exports.useCallback((F={},ee=null)=>{const Ce=k&&!n;return{...F,id:q,ref:ee,type:"radio",name:u,value:s,onChange:G(F.onChange,Q),onBlur:G($,F.onBlur,()=>E(!1)),onFocus:G(L,F.onFocus,()=>E(!0)),onKeyDown:G(F.onKeyDown,K),onKeyUp:G(F.onKeyUp,re),checked:W,disabled:Ce,readOnly:M,required:N,"aria-invalid":me(I),"aria-disabled":me(Ce),"aria-required":me(N),"data-readonly":A(M),"aria-describedby":v,style:Bt}},[k,n,q,u,s,Q,$,L,K,re,W,M,N,I,v]);return{state:{isInvalid:I,isFocused:w,isChecked:W,isActive:Y,isHovered:p,isDisabled:k,isReadOnly:M,isRequired:N},getCheckboxProps:C,getInputProps:se,getLabelProps:(F={},ee=null)=>({...F,ref:ee,onMouseDown:G(F.onMouseDown,Fe),onTouchStart:G(F.onTouchStart,Fe),"data-disabled":A(k),"data-checked":A(W),"data-invalid":A(I)}),getRootProps:(F,ee=null)=>({...F,ref:ee,"data-disabled":A(k),"data-checked":A(W),"data-invalid":A(I)}),htmlProps:x}}function Fe(e){e.preventDefault(),e.stopPropagation()}var He=Ie((e,o)=>{var V;const t=Qe(),{onChange:n,value:a}=e,i=$e("Radio",{...t,...e}),l=Xe(e),{spacing:c="0.5rem",children:d,isDisabled:u=t==null?void 0:t.isDisabled,isFocusable:s=t==null?void 0:t.isFocusable,inputProps:h,...m}=l;let v=e.isChecked;(t==null?void 0:t.value)!=null&&a!=null&&(v=t.value===a);let x=n;(t==null?void 0:t.onChange)&&a!=null&&(x=Ot(t.onChange,n));const b=(V=e==null?void 0:e.name)!=null?V:t==null?void 0:t.name,{getInputProps:y,getCheckboxProps:f,getLabelProps:R,getRootProps:z,htmlProps:q}=Ut({...m,isChecked:v,isFocusable:s,isDisabled:u,onChange:x,name:b}),[k,M]=At(q,Ye),N=f(M),I=y(h,o),P=R(),g=Object.assign({},k,z()),w={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...i.container},E={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...i.control},p={userSelect:"none",marginStart:c,...i.label};return ne.createElement(le.label,{className:"chakra-radio",...g,__css:w},r("input",{className:"chakra-radio__input",...I}),ne.createElement(le.span,{className:"chakra-radio__control",...N,__css:E}),d&&ne.createElement(le.span,{className:"chakra-radio__label",...P,__css:p},d))});He.displayName="Radio";ze.extend(ft);const Qt=({onClick:e,active:o,question_title:t,answered_at:n,answered_by_name:a,answered_by_profile:i})=>S(_.exports.Fragment,{children:[S(de,{p:3,_hover:{backgroundColor:"rgba(104,211,145,0.35)"},onClick:e,backgroundColor:o?"rgba(104,211,145,0.50)":"transparent",cursor:"pointer",children:[r(j,{fontSize:15,fontWeight:"medium",noOfLines:2,children:t}),S(H,{alignItems:"center",children:[r(ae,{label:r(j,{fontSize:11,children:"Answered By"}),direction:"column",value:S(H,{gap:2,alignItems:"center",children:[r(mt,{size:"xs",objectFit:"cover",name:a!=null?a:"",src:i?`/api/v1/profiles/${i}`:"/default-image.jpg"}),r(j,{fontSize:12,children:a!=null?a:""})]})}),r(ae,{label:r(j,{fontSize:11,children:"Answered At"}),direction:"column",value:n?r(j,{fontSize:12,children:ze(n).fromNow()}):"-"})]}),r(Pe,{my:1}),S(H,{alignItems:"center",gap:2,children:[r(ie,{label:"0 Comments",children:S(H,{gap:1,children:[r(ht,{fontSize:20}),r(j,{fontSize:13,opacity:.5,children:"0"})]})}),r(ie,{label:"2 Attachments",children:S(H,{gap:1,children:[r(pt,{fontSize:20}),r(j,{fontSize:13,opacity:.5,children:"0"})]})})]})]}),r(Pe,{})]}),Gt=({id:e,placeholder:o,label:t,isRequired:n=!1,errorMessage:a,type:i="text",leftElement:l,rightElement:c,isInvalid:d=!1,formState:u,direction:s="row",options:h,...m})=>S(it,{isRequired:n,isInvalid:d,children:[t&&t!==""?r(st,{htmlFor:e,children:t}):null,S(lt,{children:[l&&r(ct,{pointerEvents:"none",alignItems:"center",children:l}),r(Ge,{...m,children:r(Je,{direction:s,children:h&&h.length>0?h.map(v=>r(He,{value:v.value,children:v.label})):null})}),c&&r(ut,{alignItems:"center",children:c})]}),r(dt,{children:a})]}),Ht=({options:e})=>{const{control:o,formState:t,watch:n}=_e(),a=n("choosed"),i=_.exports.useMemo(()=>{if(e&&e.length>0){const l=e.find(c=>c.name===a);return r(_.exports.Fragment,{children:l&&l.conditions&&l.conditions.length>0&&l.conditions.map((c,d)=>r(B,{children:r(Z,{control:o,formState:t,name:c.name,label:c.name,id:c.name,rules:{required:{value:c.is_mandatory,message:"Dibutuhkan"}},children:r(fe,{rows:3})})}))})}else return null},[a,e]);return S(he,{templateColumns:"repeat(1,1fr)",gap:5,children:[e&&e.length>0?r(B,{children:r(Z,{control:o,formState:t,name:"choosed",id:"choosed",rules:{required:{value:!0,message:"Dibutuhkan"}},children:r(Gt,{options:e.map(l=>({label:l.name,value:l.name})),direction:"column"})})}):r(B,{children:r(Z,{control:o,formState:t,name:"description",id:"description",label:"Deskripsi",rules:{required:{value:!0,message:"Dibutuhkan"}},children:r(fe,{rows:3})})}),i,r(B,{children:r(Z,{control:o,formState:t,name:"keterangan",label:"Keterangan",id:"keterangan",children:r(fe,{rows:5})})})]})},Vt=({editable:e=!1,data:o,onAnswer:t,initialValues:n={choosed:null,keterangan:null,attachment:void 0},isLoading:a=!1,getDetailLoading:i=!1})=>S(_.exports.Fragment,{children:[r(yt,{children:S(H,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[r(j,{fontWeight:"medium",fontSize:19,children:o.name}),e?r(ie,{label:"Edit Question",children:r(ue,{"aria-label":"Edit",variant:"unstyled",icon:r(ge,{fontSize:28,color:"yellow.400"})})}):null]})}),S(ce,{x:6,y:6,children:[i&&"Loading...",!i&&S(xe,{onSubmit:t,id:"form-question",initialValues:n,children:[r(Ht,{options:o.answers}),r(oe,{type:"submit",mt:5,isLoading:a,children:"Submit"})]})]})]}),Kt=ne.forwardRef(({name:e,onChange:o,onBlur:t,value:n,placeholder:a},i)=>{const[l,c]=_.exports.useState(""),d=_t(l,1e3),{fetchNextPage:u,hasNextPage:s,isError:h,isSuccess:m,isLoading:v,data:x,isFetchingNextPage:b}=je(["fetch_select_users",d,n],({pageParam:f=1})=>bt({current:f,search:d,value:n==null?void 0:n.value,pageSize:15}),{getNextPageParam:f=>Ne(f),getPreviousPageParam:f=>We(f)}),y=xt({isSuccess:m,data:x!=null?x:{pages:[],pageParams:[]},key:"users",returnList:f=>({label:`${f.username} - ${f.full_name}`,value:f.id})});return r(Ct,{name:e,ref:i,onChange:o,onBlur:t,value:n,onInputChange:c,isLoading:b||v,isClearable:!0,noOptionsMessage:({inputValue:f})=>r("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:f})=>S(pe,{children:[S("div",{children:['Mencari "',f,'"']}),v&&r(Ze,{size:"xs",width:"100%",isIndeterminate:!0}),h&&r("div",{children:"Error saat mencari data"})]}),options:y,placeholder:r(j,{noOfLines:[1],children:a}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{s&&u()},closeMenuOnSelect:!0})}),$t=()=>{const{control:e,formState:o}=_e();return S(he,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(3,1fr)"},gap:4,children:[r(B,{children:r(Z,{placeholder:"-- Cari Pertanyaan --",control:e,name:"question_search",formState:o,id:"question_search",children:r(Ae,{})})}),r(B,{children:r(Z,{placeholder:"-- Pilih Status Pertanyaan --",control:e,name:"question_status",formState:o,id:"question_status",children:r(Se,{children:r(Pt,{type_:"QUESTION_STATUS"})})})}),r(B,{children:r(Z,{placeholder:"-- Pilih Dijawab Siapa --",control:e,name:"question_answered_by",formState:o,id:"question_answered_by",children:r(Se,{children:r(Kt,{})})})})]})},Xt=({onSubmit:e})=>r(ye,{children:S(Oe,{children:[r(j,{fontWeight:"medium",mb:3,children:"Filter data"}),S(xe,{onSubmit:e,id:"form-questionaire",children:[r($t,{}),r(oe,{leftIcon:r(Dt,{}),mt:5,size:"sm",type:"submit",children:"Filter"})]})]})}),Me="DESCRIPTION_ANSWERED";var Ve={exports:{}};/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function te(e,o,t){this.x=e,this.y=o,this.time=t||new Date().getTime()}te.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};te.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};te.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function be(e,o,t,n){this.startPoint=e,this.control1=o,this.control2=t,this.endPoint=n}be.prototype.length=function(){for(var e=10,o=0,t=void 0,n=void 0,a=0;a<=e;a+=1){var i=a/e,l=this._point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this._point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(a>0){var d=l-t,u=c-n;o+=Math.sqrt(d*d+u*u)}t=l,n=c}return o};be.prototype._point=function(e,o,t,n,a){return o*(1-e)*(1-e)*(1-e)+3*t*(1-e)*(1-e)*e+3*n*(1-e)*e*e+a*e*e*e};function Yt(e,o,t){var n,a,i,l=null,c=0;t||(t={});var d=function(){c=t.leading===!1?0:Date.now(),l=null,i=e.apply(n,a),l||(n=a=null)};return function(){var u=Date.now();!c&&t.leading===!1&&(c=u);var s=o-(u-c);return n=this,a=arguments,s<=0||s>o?(l&&(clearTimeout(l),l=null),c=u,i=e.apply(n,a),l||(n=a=null)):!l&&t.trailing!==!1&&(l=setTimeout(d,s)),i}}function D(e,o){var t=this,n=o||{};this.velocityFilterWeight=n.velocityFilterWeight||.7,this.minWidth=n.minWidth||.5,this.maxWidth=n.maxWidth||2.5,this.throttle="throttle"in n?n.throttle:16,this.minDistance="minDistance"in n?n.minDistance:5,this.throttle?this._strokeMoveUpdate=Yt(D.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=D.prototype._strokeUpdate,this.dotSize=n.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=n.penColor||"black",this.backgroundColor=n.backgroundColor||"rgba(0,0,0,0)",this.onBegin=n.onBegin,this.onEnd=n.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(a){a.which===1&&(t._mouseButtonDown=!0,t._strokeBegin(a))},this._handleMouseMove=function(a){t._mouseButtonDown&&t._strokeMoveUpdate(a)},this._handleMouseUp=function(a){a.which===1&&t._mouseButtonDown&&(t._mouseButtonDown=!1,t._strokeEnd(a))},this._handleTouchStart=function(a){if(a.targetTouches.length===1){var i=a.changedTouches[0];t._strokeBegin(i)}},this._handleTouchMove=function(a){a.preventDefault();var i=a.targetTouches[0];t._strokeMoveUpdate(i)},this._handleTouchEnd=function(a){var i=a.target===t._canvas;i&&(a.preventDefault(),t._strokeEnd(a))},this.on()}D.prototype.clear=function(){var e=this._ctx,o=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,o.width,o.height),e.fillRect(0,0,o.width,o.height),this._data=[],this._reset(),this._isEmpty=!0};D.prototype.fromDataURL=function(e){var o=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new Image,a=t.ratio||window.devicePixelRatio||1,i=t.width||this._canvas.width/a,l=t.height||this._canvas.height/a;this._reset(),n.src=e,n.onload=function(){o._ctx.drawImage(n,0,0,i,l)},this._isEmpty=!1};D.prototype.toDataURL=function(e){var o;switch(e){case"image/svg+xml":return this._toSVG();default:for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return(o=this._canvas).toDataURL.apply(o,[e].concat(n))}};D.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};D.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};D.prototype.isEmpty=function(){return this._isEmpty};D.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};D.prototype._strokeUpdate=function(e){var o=e.clientX,t=e.clientY,n=this._createPoint(o,t),a=this._data[this._data.length-1],i=a&&a[a.length-1],l=i&&n.distanceTo(i)<this.minDistance;if(!(i&&l)){var c=this._addPoint(n),d=c.curve,u=c.widths;d&&u&&this._drawCurve(d,u.start,u.end),this._data[this._data.length-1].push({x:n.x,y:n.y,time:n.time,color:this.penColor})}};D.prototype._strokeEnd=function(e){var o=this.points.length>2,t=this.points[0];if(!o&&t&&this._drawDot(t),t){var n=this._data[this._data.length-1],a=n[n.length-1];t.equals(a)||n.push({x:t.x,y:t.y,time:t.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};D.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};D.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};D.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};D.prototype._createPoint=function(e,o,t){var n=this._canvas.getBoundingClientRect();return new te(e-n.left,o-n.top,t||new Date().getTime())};D.prototype._addPoint=function(e){var o=this.points,t=void 0;if(o.push(e),o.length>2){o.length===3&&o.unshift(o[0]),t=this._calculateCurveControlPoints(o[0],o[1],o[2]);var n=t.c2;t=this._calculateCurveControlPoints(o[1],o[2],o[3]);var a=t.c1,i=new be(o[1],n,a,o[2]),l=this._calculateCurveWidths(i);return o.shift(),{curve:i,widths:l}}return{}};D.prototype._calculateCurveControlPoints=function(e,o,t){var n=e.x-o.x,a=e.y-o.y,i=o.x-t.x,l=o.y-t.y,c={x:(e.x+o.x)/2,y:(e.y+o.y)/2},d={x:(o.x+t.x)/2,y:(o.y+t.y)/2},u=Math.sqrt(n*n+a*a),s=Math.sqrt(i*i+l*l),h=c.x-d.x,m=c.y-d.y,v=s/(u+s),x={x:d.x+h*v,y:d.y+m*v},b=o.x-x.x,y=o.y-x.y;return{c1:new te(c.x+b,c.y+y),c2:new te(d.x+b,d.y+y)}};D.prototype._calculateCurveWidths=function(e){var o=e.startPoint,t=e.endPoint,n={start:null,end:null},a=this.velocityFilterWeight*t.velocityFrom(o)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(a);return n.start=this._lastWidth,n.end=i,this._lastVelocity=a,this._lastWidth=i,n};D.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};D.prototype._drawPoint=function(e,o,t){var n=this._ctx;n.moveTo(e,o),n.arc(e,o,t,0,2*Math.PI,!1),this._isEmpty=!1};D.prototype._drawCurve=function(e,o,t){var n=this._ctx,a=t-o,i=Math.floor(e.length());n.beginPath();for(var l=0;l<i;l+=1){var c=l/i,d=c*c,u=d*c,s=1-c,h=s*s,m=h*s,v=m*e.startPoint.x;v+=3*h*c*e.control1.x,v+=3*s*d*e.control2.x,v+=u*e.endPoint.x;var x=m*e.startPoint.y;x+=3*h*c*e.control1.y,x+=3*s*d*e.control2.y,x+=u*e.endPoint.y;var b=o+u*a;this._drawPoint(v,x,b)}n.closePath(),n.fill()};D.prototype._drawDot=function(e){var o=this._ctx,t=typeof this.dotSize=="function"?this.dotSize():this.dotSize;o.beginPath(),this._drawPoint(e.x,e.y,t),o.closePath(),o.fill()};D.prototype._fromData=function(e,o,t){for(var n=0;n<e.length;n+=1){var a=e[n];if(a.length>1)for(var i=0;i<a.length;i+=1){var l=a[i],c=new te(l.x,l.y,l.time),d=l.color;if(i===0)this.penColor=d,this._reset(),this._addPoint(c);else if(i!==a.length-1){var u=this._addPoint(c),s=u.curve,h=u.widths;s&&h&&o(s,h,d)}}else{this._reset();var m=a[0];t(m)}}};D.prototype._toSVG=function(){var e=this,o=this._data,t=this._canvas,n=Math.max(window.devicePixelRatio||1,1),a=0,i=0,l=t.width/n,c=t.height/n,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"width",t.width),d.setAttributeNS(null,"height",t.height),this._fromData(o,function(f,R,z){var q=document.createElement("path");if(!isNaN(f.control1.x)&&!isNaN(f.control1.y)&&!isNaN(f.control2.x)&&!isNaN(f.control2.y)){var k="M "+f.startPoint.x.toFixed(3)+","+f.startPoint.y.toFixed(3)+" "+("C "+f.control1.x.toFixed(3)+","+f.control1.y.toFixed(3)+" ")+(f.control2.x.toFixed(3)+","+f.control2.y.toFixed(3)+" ")+(f.endPoint.x.toFixed(3)+","+f.endPoint.y.toFixed(3));q.setAttribute("d",k),q.setAttribute("stroke-width",(R.end*2.25).toFixed(3)),q.setAttribute("stroke",z),q.setAttribute("fill","none"),q.setAttribute("stroke-linecap","round"),d.appendChild(q)}},function(f){var R=document.createElement("circle"),z=typeof e.dotSize=="function"?e.dotSize():e.dotSize;R.setAttribute("r",z),R.setAttribute("cx",f.x),R.setAttribute("cy",f.y),R.setAttribute("fill",f.color),d.appendChild(R)});var u="data:image/svg+xml;base64,",s='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+a+" "+i+" "+l+" "+c+'"')+(' width="'+l+'"')+(' height="'+c+'"')+">",h=d.innerHTML;if(h===void 0){var m=document.createElement("dummy"),v=d.childNodes;m.innerHTML="";for(var x=0;x<v.length;x+=1)m.appendChild(v[x].cloneNode(!0));h=m.innerHTML}var b="</svg>",y=s+h+b;return u+btoa(y)};D.prototype.fromData=function(e){var o=this;this.clear(),this._fromData(e,function(t,n){return o._drawCurve(t,n.start,n.end)},function(t){return o._drawDot(t)}),this._data=e};D.prototype.toData=function(){return this._data};const Jt=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"})),Zt=et(Jt);var ve={exports:{}},Re;function en(){return Re||(Re=1,function(e,o){(function(t,n){e.exports=n()})(Te,function(){return function(t){function n(i){if(a[i])return a[i].exports;var l=a[i]={exports:{},id:i,loaded:!1};return t[i].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}var a={};return n.m=t,n.c=a,n.p="",n(0)}([function(t,n){function a(u){var s=u.getContext("2d"),h=u.width,m=u.height,v=s.getImageData(0,0,h,m).data,x=c(!0,h,m,v),b=c(!1,h,m,v),y=d(!0,h,m,v),f=d(!1,h,m,v),R=f-y+1,z=b-x+1,q=s.getImageData(y,x,R,z);return u.width=R,u.height=z,s.clearRect(0,0,R,z),s.putImageData(q,0,0),u}function i(u,s,h,m){return{red:m[4*(h*s+u)],green:m[4*(h*s+u)+1],blue:m[4*(h*s+u)+2],alpha:m[4*(h*s+u)+3]}}function l(u,s,h,m){return i(u,s,h,m).alpha}function c(u,s,h,m){for(var v=u?1:-1,x=u?0:h-1,b=x;u?b<h:b>-1;b+=v)for(var y=0;y<s;y++)if(l(y,b,s,m))return b;return null}function d(u,s,h,m){for(var v=u?1:-1,x=u?0:s-1,b=x;u?b<s:b>-1;b+=v)for(var y=0;y<h;y++)if(l(b,y,s,m))return b;return null}Object.defineProperty(n,"__esModule",{value:!0}),n.default=a}])})}(ve)),ve.exports}(function(e,o){(function(t,n){e.exports=n(Tt.exports,_.exports,Zt,en())})(Te,function(t,n,a,i){return function(l){function c(u){if(d[u])return d[u].exports;var s=d[u]={exports:{},id:u,loaded:!1};return l[u].call(s.exports,s,s.exports,c),s.loaded=!0,s.exports}var d={};return c.m=l,c.c=d,c.p="",c(0)}([function(l,c,d){function u(P){return P&&P.__esModule?P:{default:P}}function s(P,g){var w={};for(var E in P)g.indexOf(E)>=0||Object.prototype.hasOwnProperty.call(P,E)&&(w[E]=P[E]);return w}function h(P,g){if(!(P instanceof g))throw new TypeError("Cannot call a class as a function")}function m(P,g){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||typeof g!="object"&&typeof g!="function"?P:g}function v(P,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);P.prototype=Object.create(g&&g.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(P,g):P.__proto__=g)}Object.defineProperty(c,"__esModule",{value:!0});var x=Object.assign||function(P){for(var g=1;g<arguments.length;g++){var w=arguments[g];for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(P[E]=w[E])}return P},b=function(){function P(g,w){for(var E=0;E<w.length;E++){var p=w[E];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}return function(g,w,E){return w&&P(g.prototype,w),E&&P(g,E),g}}(),y=d(1),f=u(y),R=d(2),z=u(R),q=d(3),k=u(q),M=d(4),N=u(M),I=function(P){function g(){var w,E,p,V;h(this,g);for(var Y=arguments.length,U=Array(Y),J=0;J<Y;J++)U[J]=arguments[J];return E=p=m(this,(w=g.__proto__||Object.getPrototypeOf(g)).call.apply(w,[this].concat(U))),p._sigPad=null,p._excludeOurProps=function(){var T=p.props,O=(T.canvasProps,T.clearOnResize,s(T,["canvasProps","clearOnResize"]));return O},p.getCanvas=function(){return p._canvas},p.getTrimmedCanvas=function(){var T=document.createElement("canvas");return T.width=p._canvas.width,T.height=p._canvas.height,T.getContext("2d").drawImage(p._canvas,0,0),(0,N.default)(T)},p.getSignaturePad=function(){return p._sigPad},p._checkClearOnResize=function(){p.props.clearOnResize&&p._resizeCanvas()},p._resizeCanvas=function(){var T=p.props.canvasProps||{},O=T.width,W=T.height;if(!O||!W){var Q=p._canvas,K=Math.max(window.devicePixelRatio||1,1);O||(Q.width=Q.offsetWidth*K),W||(Q.height=Q.offsetHeight*K),Q.getContext("2d").scale(K,K),p.clear()}},p.on=function(){return window.addEventListener("resize",p._checkClearOnResize),p._sigPad.on()},p.off=function(){return window.removeEventListener("resize",p._checkClearOnResize),p._sigPad.off()},p.clear=function(){return p._sigPad.clear()},p.isEmpty=function(){return p._sigPad.isEmpty()},p.fromDataURL=function(T,O){return p._sigPad.fromDataURL(T,O)},p.toDataURL=function(T,O){return p._sigPad.toDataURL(T,O)},p.fromData=function(T){return p._sigPad.fromData(T)},p.toData=function(){return p._sigPad.toData()},V=E,m(p,V)}return v(g,P),b(g,[{key:"componentDidMount",value:function(){this._sigPad=new k.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var w=this,E=this.props.canvasProps;return z.default.createElement("canvas",x({ref:function(p){w._canvas=p}},E))}}]),g}(R.Component);I.propTypes={velocityFilterWeight:f.default.number,minWidth:f.default.number,maxWidth:f.default.number,minDistance:f.default.number,dotSize:f.default.oneOfType([f.default.number,f.default.func]),penColor:f.default.string,throttle:f.default.number,onEnd:f.default.func,onBegin:f.default.func,canvasProps:f.default.object,clearOnResize:f.default.bool},I.defaultProps={clearOnResize:!0},c.default=I},function(l,c){l.exports=t},function(l,c){l.exports=n},function(l,c){l.exports=a},function(l,c){l.exports=i}])})})(Ve);const tn=tt(Ve.exports),nn=_.exports.forwardRef(({},e)=>{const{formState:o,control:t}=_e();return S(pe,{children:[r(Z,{control:t,formState:o,label:"PIC",name:"pic",id:"pic",rules:{required:{value:!0,message:"Dibutuhkan"}},children:r(Ae,{})}),S(de,{mt:5,children:[S(H,{justifyContent:"space-between",alignItems:"center",children:[r(j,{fontSize:"xs",children:"*Input Tanda Tangan"}),r(oe,{variant:"link",size:"xs",onClick:()=>{var n;(n=e==null?void 0:e.current)==null||n.clear()},children:"Clear Signature"})]}),r(de,{border:"1px solid black",children:r(tn,{penColor:"black",ref:e,canvasProps:{width:400,height:200,className:"sigCanvas"},backgroundColor:"#fff"})})]})]})}),on=({projectId:e,structureId:o})=>{const t=_.exports.useRef(),n=qe(),a=Le(),i=nt(),l=Be(wt);return S(xe,{onSubmit:d=>{var u;l.mutate({projectId:e,structureId:o,pic:d.pic,signature:(u=t.current)==null?void 0:u.getTrimmedCanvas().toDataURL("image/png")},{onSuccess:s=>{a({status:"success",title:"success",description:s.message,position:"top",isClosable:!0}),i.invalidateQueries(["detail_structure"]),n(Ee())},onError:s=>Ue(s,a)})},id:"form-submit",children:[r(de,{p:5,children:r(nn,{ref:t})}),r(qt,{children:S(H,{gap:5,alignItems:"center",children:[r(oe,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>{n(Ee())},children:"Close"}),r(oe,{size:"sm",type:"submit",isLoading:l.isLoading,children:"Submit"})]})})]})},Gn=_.exports.forwardRef(({structuresId:e,projectId:o,editable:t=!1},n)=>{var O,W,Q,K,re;const a=qe(),[i,l]=_.exports.useState(e),[c,d]=_.exports.useState(o),[u]=ot(),[s,h]=_.exports.useState(null),[m,v]=_.exports.useState({question_answered_by:null,question_search:null,question_status:null});_.exports.useImperativeHandle(n,()=>({removeFilterQuestions(){v({question_answered_by:null,question_search:null,question_status:null}),h(null)}}));const x=Le(),b=Be(St);_.exports.useEffect(()=>{d(o!=null?o:+u.get("projectId")),l(e!=null?e:u.get("structureId"))},[e,u.get("structureId"),o,u.get("projectId")]);const{isSuccess:y,isLoading:f,isError:R,data:z}=we(["detail_structure",i,c],()=>kt({structureId:i,projectId:c}),{enabled:!!i&&!!c}),{isSuccess:q,isLoading:k,isError:M,refetch:N,data:I,hasNextPage:P,fetchNextPage:g}=je(["questions",i,c,{...m}],({pageParam:C=1})=>Et({id:i,prjId:c,current:C,answered_by:m.question_answered_by,status_answered:m.question_status,search:m.question_search,pageSize:15}),{enabled:!!i,getNextPageParam:C=>Ne(C),getPreviousPageParam:C=>We(C)}),{data:w,isLoading:E,isSuccess:p}=we(["answered_question",s==null?void 0:s.id],()=>Rt(s==null?void 0:s.id),{cacheTime:0,staleTime:0,enabled:!!(s!=null&&s.id)}),V=_.exports.useMemo(()=>{let C={};return p?(w.data.conditions&&w.data.conditions.map(L=>{C[L.label]=L.value}),w.data.answer_label===Me?{description:w.data.description,keterangan:w.data.note,attachment:void 0,...C}:{choosed:w.data.answer_label,keterangan:w.data.note,attachment:void 0,...C}):{choosed:null,keterangan:null,attachment:void 0}},[p,w]),Y=C=>{var L,$;h(null),v({question_status:(L=C.question_status)==null?void 0:L.value,question_search:C.question_search,question_answered_by:($=C.question_answered_by)==null?void 0:$.value})},U=C=>{var se;let L,$;C!=null&&C.choosed?($=s.answers.find(X=>X.name===C.choosed),L=$.conditions.map(X=>({label:X.name,value:C==null?void 0:C[X.name]}))):L=null,b.mutate({answer:{conditions:L,keterangan:C.keterangan,label:(se=C==null?void 0:C.choosed)!=null?se:Me,value:$?$.value.toString():C.description},question_id:s.id},{onSuccess:X=>{x({position:"top",title:"Success",description:X.message,isClosable:!0}),h(null),N()},onError:X=>Ue(X,x)})},J=C=>{h(C)},T=()=>{a(It(r(on,{projectId:c,structureId:i}),"Edit PIC Questioner","md"))};return r(_.exports.Fragment,{children:M?r(Ft,{}):S(_.exports.Fragment,{children:[S(ce,{x:0,y:2,children:[f&&r(Lt,{w:"100%",h:100}),R&&r(j,{children:"Error Menampilkan Detail Struktur"}),y&&r(ye,{children:r(Oe,{children:S(H,{justifyContent:"space-between",alignItems:"center",children:[S(he,{templateColumns:{base:"repeat(1,1fr)",lg:"repeat(3,1fr)"},flex:1,children:[r(B,{children:r(ae,{maxW:"100%",direction:"column",label:"Unit Kerja",value:z.data.name})}),r(B,{children:r(ae,{maxW:"100%",direction:"column",label:"Counterpart",value:(W=(O=z.data.questioner_info)==null?void 0:O[0])==null?void 0:W.pic})}),r(B,{children:r(ae,{maxW:"100%",direction:"column",label:"TTD Counterpart",value:r("img",{src:(K=(Q=z.data.questioner_info)==null?void 0:Q[0])==null?void 0:K.signature,style:{width:300,height:"auto"}})})})]}),t?r(ie,{label:"Edit PIC",children:r(ue,{"aria-label":"Edit",onClick:T,variant:"unstyled",icon:r(ge,{fontSize:28,color:"yellow.400"})})}):!z.data.questioner_info&&r(ie,{label:"Edit PIC",children:r(ue,{"aria-label":"Edit",onClick:T,variant:"unstyled",icon:r(ge,{fontSize:28,color:"yellow.400"})})})]})})})]}),r(ce,{x:0,y:2,children:r(Xt,{onSubmit:Y})}),r(ce,{x:0,y:3,children:r(ye,{children:S(he,{templateColumns:"repeat(5,1fr)",children:[S(B,{colSpan:{base:5,lg:s?2:5},display:{base:s?"none":"block",lg:"block"},borderRight:{base:0,lg:.5},borderStyle:"solid",borderColor:"grey.200",maxH:{lg:700},minH:{base:700},overflowY:{lg:"auto"},_dark:{borderColor:"grey.600"},children:[k&&r(rt,{}),q&&I.pages[0].questions&&((re=I.pages[0].questions)==null?void 0:re.length)>0?S(pe,{children:[I.pages.map(C=>C.questions&&C.questions.length>0?r(pe,{children:C.questions.map(L=>r(Qt,{question_title:L.name,onClick:()=>J(L),answered_at:L.answered_at,active:(s==null?void 0:s.id)===(L==null?void 0:L.id),answered_by_name:L.answered_by_name,answered_by_profile:L.answered_by_profile}))}):r(ke,{})),P&&r(H,{my:5,justifyContent:"center",children:r(oe,{size:"sm",onClick:()=>g(),children:"Load More"})})]}):r(H,{alignItems:"center",justifyContent:"center",h:"100%",children:r(ke,{})})]}),s&&S(B,{colSpan:{base:s?5:0,lg:3},display:{base:s?"block":"none",lg:"block"},children:[r(ue,{"aria-label":"Comeback",display:{base:"block",lg:"none"},variant:"link",fontSize:28,onClick:()=>h(null),icon:r(Mt,{}),ml:5,mt:5}),r(Vt,{editable:t,data:s,onAnswer:U,initialValues:V,getDetailLoading:E,isLoading:b.isLoading})]})]})})})]})})});export{Gn as default};
