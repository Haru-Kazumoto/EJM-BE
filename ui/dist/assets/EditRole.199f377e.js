import{aV as P,e as S,c as v,Y as j,g as y,r as M,j as l,a as n,h as x}from"./index.0e24cb86.js";import{P as B}from"./Page.b0ec3cd0.js";import{P as D}from"./PageHeader.55df2133.js";import{P as L}from"./PagePadding.f9f1bdac.js";import{a as N}from"./FormFieldControl.6d022860.js";import{u as T,C as m,F as A}from"./FormFieldRole.e20eb906.js";import{S as F}from"./SaveIcon.a38dc1b6.js";import{b as H,u as _}from"./rolesActions.f6ba71e7.js";import{u as k,E as K}from"./useError.ed61bdd7.js";import{B as O}from"./index.esm.726820fc.js";import"./ArrowLeftIcon.12227cb3.js";import"./index.esm.008f63b2.js";import"./index.esm.25501534.js";import"./FieldText.629ceab0.js";import"./FieldCustom.a890d568.js";import"./FieldSwitch.02ffd7e0.js";import"./index.esm.68da116c.js";import"./index.238261e4.js";import"./menusAction.62a37d2d.js";const re=()=>{var E,h;const{items:i,isLoading:I,isSuccess:d}=T(),{id:c}=P(),p=S(),b=v(),R=j(),{data:t,isLoading:f,isSuccess:o}=y(["detail_role",c],()=>H(+c),{enabled:!!c,keepPreviousData:!1,cacheTime:0,refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,refetchOnMount:!1,refetchOnReconnect:!1}),g=k(_),C=a=>{let r=[];a.menus.filter(e=>e.type==="menu"&&(e.state===m.CHECKED||e.state===m.INDETERMINATE)).map(e=>{r.push({menuId:e.id,apiId:a.menus.filter(s=>s.type==="api"&&s.parentId===e.id&&(s.state===m.CHECKED||s.state===m.INDETERMINATE)).map(s=>s.id)})}),g.mutate({id:c,name:a.name,active:a.active,actionApi:r,objectActions:a.menus},{onSuccess:e=>{p({title:"Success",description:e.message,position:"top",status:"success",isClosable:!0}),R.invalidateQueries(["roles"]),b("/management/roles")},onError:e=>K(e,p)})},u=M.exports.useMemo(()=>o&&t.data.object_menus&&t.data.object_menus.length>0?i.map(a=>{var r,e;return{...a,state:(e=(r=t.data.object_menus.find(s=>s.id===a.id))==null?void 0:r.state)!=null?e:m.UNCHECKED}}):i,[t,o,d,i,f,o]);return l(B,{title:`Edit Role ${(E=o&&t.data.name)!=null?E:"-"}`,children:[n(D,{label:`Edit Role ${(h=o&&t.data.name)!=null?h:"-"}`,useBackButton:!0}),l(L,{x:6,children:[f||I&&n(x,{}),o&&d&&u&&u.length>0&&l(N,{onSubmit:C,id:"form-role",initialValues:{name:t.data.name,active:t.data.is_active,menus:u},children:[n(A,{items:i}),n(O,{type:"submit",mt:5,leftIcon:n(F,{}),isLoading:g.isLoading,children:"Submit"})]})]})]})};export{re as default};
