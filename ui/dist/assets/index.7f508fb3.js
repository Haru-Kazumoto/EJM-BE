import{c as O,a as e,j as s,ar as v,as as l,F as i,T as h,ao as I,B as b,an as D,D as F,ak as Y,i as j,r as L,h as B}from"./index.0e24cb86.js";import{P as G}from"./Page.b0ec3cd0.js";import{P as V}from"./PageHeader.55df2133.js";import{u as R,A as q}from"./useSelector.000aa598.js";import{P as N}from"./PagePadding.f9f1bdac.js";import{d as C}from"./dayjs.min.de763c4f.js";import{C as S,a as k,c as H,b as U}from"./index.esm.6acc2bf5.js";import{A as g,a as W}from"./index.esm.ba2a2cc9.js";import{T as Q}from"./index.esm.008f63b2.js";import{S as K}from"./SearchInput.6e0cefa2.js";import{E as T}from"./ErrorEmpty.82811164.js";import{u as $,G as X,b as J,a as Z}from"./useSelectDataMapper.c05d958f.js";import{u as ee}from"./useDebounce.f82902b3.js";import{p as re}from"./projectActions.133a6b49.js";import{L as se}from"./LogActivity.0fdd5bbf.js";import{r as ae}from"./relativeTime.1fcc03b9.js";import{B as E}from"./index.esm.726820fc.js";import{T as te,a as ne,b as y,c as ie}from"./index.esm.362f1310.js";import"./ArrowLeftIcon.12227cb3.js";import"./index.esm.25501534.js";import"./useTranslation.d6d641af.js";import"./slicedToArray.49cdadd5.js";import"./CommentsIcon.7c801b68.js";const oe=({data:r})=>{const a=O();return e(S,{_hover:{borderColor:"brand.light",borderWidth:2,boxSizing:"border-box"},onClick:()=>{a(`/activity/projects/questionaire/${r.project_code}?projectId=${r.project_id}&structureId=${r.structure_id}`)},cursor:"pointer",children:e(k,{children:s(v,{justifyContent:"space-between",gridTemplateColumns:{base:"repeat(1,1fr)",lg:"repeat(3,1fr)"},flexDirection:{base:"column",lg:"row"},gap:{base:5,lg:0},children:[e(l,{children:s(i,{gap:5,alignItems:"center",children:[e(g,{name:r.company_name,src:r.company_profile_pict?`/api/v1/profiles/${r.company_profile_pict}`:null}),s(i,{gap:1,flexDirection:"column",children:[e(Q,{label:r.structure_name,children:e(h,{fontWeight:"semibold",fontSize:"lg",noOfLines:[1],children:r.structure_name})}),s(h,{fontWeight:"semibold",fontSize:"xs",children:["Assigned At : ",C(r.assigned_at).format("DD MMMM YYYY")]}),s(i,{gap:1,children:[e(I,{colorScheme:"blue",width:"min-content",children:r.project_type}),e(I,{colorScheme:"grey",width:"min-content",children:r.project_code})]})]})]})}),e(l,{justifySelf:{base:"start",lg:"center"},children:s(W,{size:{base:"sm",md:"md"},max:8,children:[e(g,{name:"Ryan Florence",src:"https://bit.ly/ryan-florence"}),e(g,{name:"Segun Adebayo",src:"https://bit.ly/sage-adebayo"}),e(g,{name:"Kent Dodds",src:"https://bit.ly/kent-c-dodds"}),e(g,{name:"Prosper Otemuyiwa",src:"https://bit.ly/prosper-baba"}),e(g,{name:"Christian Nwamba",src:"https://bit.ly/code-beast"})]})}),e(l,{children:s(b,{children:[e(h,{mb:1,children:"Progress"}),s(i,{alignItems:"center",gap:2,children:[e(D,{value:0,size:"xs",colorScheme:"green",flex:1}),e(h,{children:"0%"})]})]})})]})})})},z=({label:r,children:a,action:o})=>s(S,{maxH:450,children:[e(H,{children:r}),e(k,{overflowY:"auto",minH:300,children:a}),e(F,{}),e(U,{children:"View All"})]}),P=({label:r,value:a})=>e(S,{children:s(k,{p:{base:2,md:5},children:[s(i,{gap:5,alignItems:"center",children:[e(b,{w:5,h:5,bg:"green.300",borderRadius:50}),e(h,{fontWeight:"medium",noOfLines:[1],children:r})]}),e(h,{fontSize:38,mt:5,textAlign:"center",children:a})]})}),ce=async({pageSize:r,current:a,search:o,user_id:u,job:p})=>{const c=o&&o!=""?`&search=${o}`:"";return(await Y.get(`/assigned-tasks?page=${a!=null?a:1}&page_size=${r!=null?r:10}&user_id=${u}&job=${p}`+c)).data};C.extend(ae);const le=({userId:r})=>{var f;const{fetchNextPage:a,hasNextPage:o,isError:u,isSuccess:p,isLoading:c,data:d,isFetchingNextPage:A}=$(["log_project",r],({pageParam:t=1})=>re({current:t,search:"",userId:r,pageSize:15}),{getNextPageParam:t=>X(t),getPreviousPageParam:t=>J(t)});return s(z,{label:"Aktivitas Terakhir",children:[c&&e(D,{size:"xs",isIndeterminate:!0}),p&&d.pages[0].logs&&((f=d.pages[0].logs)==null?void 0:f.length)>0?s(j,{children:[d.pages.map(t=>t.logs&&t.logs.length>0?e(j,{children:t.logs.map((m,x)=>e(b,{mb:3,children:e(se,{comment:m.description,time:C(m.time).fromNow(),user:m.user.name},x)}))}):e(T,{})),o&&e(i,{my:5,justifyContent:"center",children:e(E,{size:"sm",onClick:()=>a(),isLoading:c,children:"Load More"})})]}):null]})},w=["QUESTIONER","INVENTORY","VOLUME"],De=()=>{const[r,a]=L.exports.useState(0),[o,u]=L.exports.useState(""),p=ee(o,300),{id:c}=R(n=>n.session),{isSuccess:d,isLoading:A,isError:f,isFetchingNextPage:t,data:m,hasNextPage:x,fetchNextPage:M}=$(["assigned_tasks",c,w[r],p],({pageParam:n=1})=>ce({user_id:+c,pageSize:10,search:p,job:w[r],current:n})),_=Z({isSuccess:d,data:m!=null?m:{pages:[],pageParams:[]},key:"tasks",returnList:n=>e(oe,{data:n})});return s(G,{title:"Assigned Tasks",children:[e(V,{label:"Assigned Tasks",leftIcon:e(q,{fontSize:25})}),e(N,{x:6,children:s(v,{gridTemplateColumns:"repeat(7,1fr)",gap:5,children:[e(l,{colSpan:{base:7,"2xl":5},children:s(i,{flexDirection:"column",gap:5,children:[s(v,{gridTemplateColumns:{base:"repeat(1,1fr)",md:"repeat(3,1fr)"},gap:5,children:[e(l,{children:e(P,{label:"On Progress",value:0})}),e(l,{children:e(P,{label:"New Assigned",value:0})}),e(l,{children:e(P,{label:"Completed",value:0})})]}),s(te,{defaultIndex:0,onChange:n=>a(n),children:[s(ne,{overflowX:"auto",overflowY:"hidden",children:[e(y,{children:"Questioner"}),e(y,{children:"Inventory"}),e(y,{children:"Volume"})]}),s(ie,{p:0,mt:5,children:[e(K,{onChange:n=>{n.preventDefault(),u(n.target.value)}}),e(N,{x:0,y:3}),A&&e(B,{}),f&&"Error Occured",d&&s(i,{gap:5,flexDirection:"column",children:[_.length>0?_:e(T,{}),x&&e(E,{size:"sm",variant:"outline",onClick:()=>{M()},isLoading:t,children:"Load More.."})]})]})]})]})}),e(l,{colSpan:2,display:{base:"none","2xl":"block"},children:e(b,{position:"sticky",top:20,children:s(i,{flexDirection:"column",gap:5,children:[e(le,{userId:c}),e(z,{label:"Komentar Terakhir",children:e(T,{})})]})})})]})})]})};export{De as default};
