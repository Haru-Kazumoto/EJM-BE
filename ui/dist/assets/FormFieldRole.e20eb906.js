import{g as H,r as E,a as c,j as C,R as I,ar as K,as as D,D as k}from"./index.0e24cb86.js";import{u as x,F as g}from"./FormFieldControl.6d022860.js";import{F as v}from"./FieldText.629ceab0.js";import{F as A}from"./FieldCustom.a890d568.js";import{F as M}from"./FieldSwitch.02ffd7e0.js";import{b as R}from"./menusAction.62a37d2d.js";import{C as F}from"./index.esm.68da116c.js";var u=(e=>(e[e.UNCHECKED=0]="UNCHECKED",e[e.CHECKED=1]="CHECKED",e[e.INDETERMINATE=2]="INDETERMINATE",e))(u||{});const T=(e,l,d)=>{const r=e.length>0?e.map(t=>({...t})):[],h=t=>r.length>0?r.find(a=>a.id===t).state:0,n=t=>{const a=l.find(i=>i.id===t),f=l.find(i=>i.id===a.parentId);if(!f)return;const p=l.filter(i=>i.parentId===f.id).map(i=>i.id).map(i=>h(i));p.length===p.filter(i=>i===1).length?r.find(i=>i.id===f.id).state=1:p.length===p.filter(i=>i===0).length?r.find(i=>i.id===f.id).state=0:r.find(i=>i.id===f.id).state=2,n(f.id)},s=t=>{r.find(a=>a.id===t).state=0,l.filter(a=>a.parentId===t).map(a=>a.id).forEach(a=>s(a)),n(t)},o=t=>{r.find(a=>a.id===t).state=1,l.filter(a=>a.parentId===t).map(a=>a.id).forEach(a=>o(a)),n(t)};return h(d)===1?s(d):o(d),r},U=()=>{const{data:e,isSuccess:l,isLoading:d}=H(["menus"],()=>R(),{refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,refetchOnMount:!1,refetchOnReconnect:!1});return{items:E.exports.useMemo(()=>l?e.data&&e.data.length>0&&e.data.map(h=>({...h,state:u.UNCHECKED})):[],[l,e]),isLoading:d,isSuccess:l}},N=({items:e,getStateForId:l,idsToRender:d=[],indentLevel:r=0,onClick:h=()=>{}})=>{d.length||(d=e.filter(s=>!s.parentId).map(s=>s.id));const n=s=>{const o=e.filter(m=>m.parentId===s);return o.length?c(N,{items:e,idsToRender:o.map(m=>m.id),indentLevel:r+1,onClick:m=>h(m),getStateForId:l}):null};return c("ul",{style:{paddingLeft:r>0?20:0},children:d.map(s=>{const o=e.find(t=>t.id===s),m=l(s);return C(I.Fragment,{children:[c("li",{children:c(F,{onChange:()=>h(o.id),isChecked:m===u.CHECKED,isIndeterminate:m===u.INDETERMINATE,children:o.name})}),n(o.id)]},o.id)})})},b=({value:e,onChange:l,items:d=[]})=>{const r=e,{isLoading:h}=U(),n=E.exports.useCallback(s=>r&&r.length>0?r.find(o=>o.id===s).state:u.UNCHECKED,[r]);return h?c("div",{children:"Loading..."}):c(N,{items:d,getStateForId:n,onClick:s=>{l(T(r,d,s))}})},q=({items:e=[]})=>{const{control:l,formState:d,setValue:r,watch:h}=x(),n=h("menus"),[s,o]=I.useState(!1);E.exports.useEffect(()=>{const t=n&&n.length>0?n.map(a=>({...a,state:s?u.CHECKED:u.UNCHECKED})):e;r("menus",t)},[s]);const m=t=>o(!s);return c(E.exports.Fragment,{children:C(K,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)"},gap:5,children:[C(D,{gap:5,display:"flex",flexDirection:"column",children:[c(g,{control:l,name:"name",formState:d,id:"name",label:"Nama Role",rules:{required:{value:!0,message:"Nama Role Dibutuhkan"}},children:c(v,{})}),c(g,{control:l,name:"active",formState:d,id:"active",label:"Active",children:c(M,{})})]}),C(D,{children:[c(F,{onChange:m,isChecked:n&&n.length>0&&n.filter(t=>t.state===u.CHECKED).length===n.length,isIndeterminate:n&&n.length>0&&n.filter(t=>t.state===u.UNCHECKED).length>0&&n&&n.filter(t=>t.state===u.UNCHECKED).length<n.length,children:"Pilih Semua"}),c(k,{}),c(g,{control:l,name:"menus",formState:d,id:"menus",label:"Hak Akses Role",children:c(A,{children:c(b,{items:e||[]})})})]})]})})};export{u as C,q as F,U as u};
