import{G as Ye,J as Te,r as _,R as ne,K as se,H as Xe,a6 as Je,a,ap as Ze,j as S,B as ce,T as W,F as V,D as Pe,aS as et,as as B,ar as ue,i as de,an as tt,b3 as nt,aP as qe,b4 as ot,d as Le,e as ze,Y as Oe,aM as rt,g as we,h as at}from"./index.0e24cb86.js";import{i as it,F as st,a as lt,I as ct,c as ut,f as dt,g as ht,P as le}from"./PagePadding.f9f1bdac.js";import{D as ae}from"./Detailinformation.255e4d07.js";import{C as pt}from"./CommentsIcon.7c801b68.js";import{F as ft}from"./FileIcon.5750f3bf.js";import{d as Ae}from"./dayjs.min.de763c4f.js";import{r as mt}from"./relativeTime.1fcc03b9.js";import{A as vt}from"./index.esm.ba2a2cc9.js";import{T as he}from"./index.esm.008f63b2.js";import{u as _e,F as Z,a as xe}from"./FormFieldControl.6d022860.js";import{m as gt,B as oe,I as fe}from"./index.esm.726820fc.js";import{t as yt}from"./index.238261e4.js";import{F as me}from"./FieldTextArea.eda53a25.js";import{c as _t,C as ye,a as Ne}from"./index.esm.6acc2bf5.js";import{F as je}from"./FieldText.629ceab0.js";import{F as Se}from"./FieldCustom.a890d568.js";import{u as We,a as xt,G as Be,b as Ue}from"./useSelectDataMapper.c05d958f.js";import{u as bt}from"./useDebounce.f82902b3.js";import{b as Ct}from"./usersActions.997728a2.js";import{S as Pt}from"./select.f59423ba.js";import{S as wt}from"./SelectLookup.9c949968.js";import{F as St}from"./FilterIcon.eea7884e.js";import{q as kt,r as Et,t as Dt,v as Ft}from"./projectActions.133a6b49.js";import{E as Mt}from"./ErrorFetching.2cd1a256.js";import{u as Qe,E as Ge}from"./useError.ed61bdd7.js";import{A as It}from"./ArrowLeftIcon.12227cb3.js";import{f as Rt}from"./questionActions.28a337fa.js";import{E as ke}from"./ErrorEmpty.82811164.js";import{E as Ee}from"./EditIcon.0dd57a11.js";import{c as De,o as Tt}from"./uiActions.408d82e2.js";import{p as qt}from"./Page.b0ec3cd0.js";import{f as Lt}from"./index.esm.3048a115.js";import{S as zt}from"./index.esm.e1b3c63e.js";import"./index.esm.25501534.js";import"./slicedToArray.49cdadd5.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./index.esm.9fed1f3b.js";import"./useTranslation.d6d641af.js";import"./inheritsLoose.5105dba6.js";var Ot=(...e)=>e.filter(Boolean).join(" ");function Fe(e){const o=typeof e;return e!=null&&(o==="object"||o==="function")&&!Array.isArray(e)}var A=e=>e?"":void 0,ve=e=>e?!0:void 0;function H(...e){return function(t){e.some(n=>(n==null||n(t),t==null?void 0:t.defaultPrevented))}}function At(...e){return function(t){e.forEach(n=>{n==null||n(t)})}}function Nt(e,o){const t={},n={};for(const[r,i]of Object.entries(e))o.includes(r)?t[r]=i:n[r]=i;return[t,n]}function jt(e){return e&&Fe(e)&&Fe(e.target)}function Wt(e={}){const{onChange:o,value:t,defaultValue:n,name:r,isDisabled:i,isFocusable:l,isNative:c,...d}=e,[u,s]=_.exports.useState(n||""),h=typeof t<"u",m=h?t:u,v=_.exports.useRef(null),x=_.exports.useCallback(()=>{const k=v.current;if(!k)return;let M="input:not(:disabled):checked";const N=k.querySelector(M);if(N){N.focus();return}M="input:not(:disabled)";const L=k.querySelector(M);L==null||L.focus()},[]),g=`radio-${_.exports.useId()}`,f=r||g,I=_.exports.useCallback(k=>{const M=jt(k)?k.target.value:k;h||s(M),o==null||o(String(M))},[o,h]),z=_.exports.useCallback((k={},M=null)=>({...k,ref:gt(M,v),role:"radiogroup"}),[]),R=_.exports.useCallback((k={},M=null)=>({...k,ref:M,name:f,[c?"checked":"isChecked"]:m!=null?k.value===m:void 0,onChange(L){I(L)},"data-radiogroup":!0}),[c,f,I,m]);return{getRootProps:z,getRadioProps:R,name:f,ref:v,focus:x,setValue:s,value:m,onChange:I,isDisabled:i,isFocusable:l,htmlProps:d}}var[Bt,He]=Ye({name:"RadioGroupContext",strict:!1}),Ve=Te((e,o)=>{const{colorScheme:t,size:n,variant:r,children:i,className:l,isDisabled:c,isFocusable:d,...u}=e,{value:s,onChange:h,getRootProps:m,name:v,htmlProps:x}=Wt(u),P=_.exports.useMemo(()=>({name:v,size:n,onChange:h,colorScheme:t,value:s,variant:r,isDisabled:c,isFocusable:d}),[v,n,h,t,s,r,c,d]);return ne.createElement(Bt,{value:P},ne.createElement(se.div,{...m(x,o),className:Ot("chakra-radio-group",l)},i))});Ve.displayName="RadioGroup";var Ut={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function Qt(e={}){const{defaultChecked:o,isChecked:t,isFocusable:n,isDisabled:r,isReadOnly:i,isRequired:l,onChange:c,isInvalid:d,name:u,value:s,id:h,"data-radiogroup":m,"aria-describedby":v,...x}=e,P=`radio-${_.exports.useId()}`,g=it(),I=!!He()||!!m;let R=!!g&&!I?g.id:P;R=h!=null?h:R;const k=r!=null?r:g==null?void 0:g.isDisabled,M=i!=null?i:g==null?void 0:g.isReadOnly,N=l!=null?l:g==null?void 0:g.isRequired,L=d!=null?d:g==null?void 0:g.isInvalid,[b,y]=_.exports.useState(!1),[D,w]=_.exports.useState(!1),[p,U]=_.exports.useState(!1),[X,Q]=_.exports.useState(!1),[J,T]=_.exports.useState(Boolean(o)),O=typeof t<"u",j=O?t:J;_.exports.useEffect(()=>yt(y),[]);const G=_.exports.useCallback(F=>{if(M||k){F.preventDefault();return}O||T(F.target.checked),c==null||c(F)},[O,k,M,c]),K=_.exports.useCallback(F=>{F.key===" "&&Q(!0)},[Q]),re=_.exports.useCallback(F=>{F.key===" "&&Q(!1)},[Q]),ie=_.exports.useCallback((F={},ee=null)=>({...F,ref:ee,"data-active":A(X),"data-hover":A(p),"data-disabled":A(k),"data-invalid":A(L),"data-checked":A(j),"data-focus":A(D),"data-focus-visible":A(D&&b),"data-readonly":A(M),"aria-hidden":!0,onMouseDown:H(F.onMouseDown,()=>Q(!0)),onMouseUp:H(F.onMouseUp,()=>Q(!1)),onMouseEnter:H(F.onMouseEnter,()=>U(!0)),onMouseLeave:H(F.onMouseLeave,()=>U(!1))}),[X,p,k,L,j,D,M,b]),{onFocus:C,onBlur:q}=g!=null?g:{},$=_.exports.useCallback((F={},ee=null)=>{const Ce=k&&!n;return{...F,id:R,ref:ee,type:"radio",name:u,value:s,onChange:H(F.onChange,G),onBlur:H(q,F.onBlur,()=>w(!1)),onFocus:H(C,F.onFocus,()=>w(!0)),onKeyDown:H(F.onKeyDown,K),onKeyUp:H(F.onKeyUp,re),checked:j,disabled:Ce,readOnly:M,required:N,"aria-invalid":ve(L),"aria-disabled":ve(Ce),"aria-required":ve(N),"data-readonly":A(M),"aria-describedby":v,style:Ut}},[k,n,R,u,s,G,q,C,K,re,j,M,N,L,v]);return{state:{isInvalid:L,isFocused:D,isChecked:j,isActive:X,isHovered:p,isDisabled:k,isReadOnly:M,isRequired:N},getCheckboxProps:ie,getInputProps:$,getLabelProps:(F={},ee=null)=>({...F,ref:ee,onMouseDown:H(F.onMouseDown,Me),onTouchStart:H(F.onTouchStart,Me),"data-disabled":A(k),"data-checked":A(j),"data-invalid":A(L)}),getRootProps:(F,ee=null)=>({...F,ref:ee,"data-disabled":A(k),"data-checked":A(j),"data-invalid":A(L)}),htmlProps:x}}function Me(e){e.preventDefault(),e.stopPropagation()}var Ke=Te((e,o)=>{var U;const t=He(),{onChange:n,value:r}=e,i=Xe("Radio",{...t,...e}),l=Je(e),{spacing:c="0.5rem",children:d,isDisabled:u=t==null?void 0:t.isDisabled,isFocusable:s=t==null?void 0:t.isFocusable,inputProps:h,...m}=l;let v=e.isChecked;(t==null?void 0:t.value)!=null&&r!=null&&(v=t.value===r);let x=n;(t==null?void 0:t.onChange)&&r!=null&&(x=At(t.onChange,n));const P=(U=e==null?void 0:e.name)!=null?U:t==null?void 0:t.name,{getInputProps:g,getCheckboxProps:f,getLabelProps:I,getRootProps:z,htmlProps:R}=Qt({...m,isChecked:v,isFocusable:s,isDisabled:u,onChange:x,name:P}),[k,M]=Nt(R,Ze),N=f(M),L=g(h,o),b=I(),y=Object.assign({},k,z()),D={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...i.container},w={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...i.control},p={userSelect:"none",marginStart:c,...i.label};return ne.createElement(se.label,{className:"chakra-radio",...y,__css:D},a("input",{className:"chakra-radio__input",...L}),ne.createElement(se.span,{className:"chakra-radio__control",...N,__css:w}),d&&ne.createElement(se.span,{className:"chakra-radio__label",...b,__css:p},d))});Ke.displayName="Radio";Ae.extend(mt);const Gt=({onClick:e,active:o,question_title:t,answered_at:n,answered_by_name:r,answered_by_profile:i})=>S(_.exports.Fragment,{children:[S(ce,{p:3,_hover:{backgroundColor:"rgba(104,211,145,0.35)"},onClick:e,backgroundColor:o?"rgba(104,211,145,0.50)":"transparent",cursor:"pointer",children:[a(W,{fontSize:15,fontWeight:"medium",noOfLines:2,children:t}),S(V,{alignItems:"center",children:[a(ae,{label:a(W,{fontSize:11,children:"Answered By"}),direction:"column",value:S(V,{gap:2,alignItems:"center",children:[a(vt,{size:"xs",objectFit:"cover",name:r!=null?r:"",src:i?`/api/v1/profiles/${i}`:"/default-image.jpg"}),a(W,{fontSize:12,children:r!=null?r:""})]})}),a(ae,{label:a(W,{fontSize:11,children:"Answered At"}),direction:"column",value:n?a(W,{fontSize:12,children:Ae(n).fromNow()}):"-"})]}),a(Pe,{my:1}),S(V,{alignItems:"center",gap:2,children:[a(he,{label:"0 Comments",children:S(V,{gap:1,children:[a(pt,{fontSize:20}),a(W,{fontSize:13,opacity:.5,children:"0"})]})}),a(he,{label:"0 Attachments",children:S(V,{gap:1,children:[a(ft,{fontSize:20}),a(W,{fontSize:13,opacity:.5,children:"0"})]})})]})]}),a(Pe,{})]}),Ht=({id:e,placeholder:o,label:t,isRequired:n=!1,errorMessage:r,type:i="text",leftElement:l,rightElement:c,isInvalid:d=!1,formState:u,direction:s="row",options:h,...m})=>S(st,{isRequired:n,isInvalid:d,children:[t&&t!==""?a(lt,{htmlFor:e,children:t}):null,S(ct,{children:[l&&a(ut,{pointerEvents:"none",alignItems:"center",children:l}),a(Ve,{...m,children:a(et,{direction:s,children:h&&h.length>0?h.map(v=>a(Ke,{value:v.value,children:v.label})):null})}),c&&a(dt,{alignItems:"center",children:c})]}),a(ht,{children:r})]}),Vt=({options:e})=>{const{control:o,formState:t,watch:n}=_e(),r=n("choosed"),i=_.exports.useMemo(()=>{if(e&&e.length>0){const l=e.find(c=>c.name===r);return a(_.exports.Fragment,{children:l&&l.conditions&&l.conditions.length>0&&l.conditions.map((c,d)=>a(B,{children:a(Z,{control:o,formState:t,name:c.name,label:c.name,id:c.name,rules:{required:{value:c.is_mandatory,message:"Dibutuhkan"}},children:a(me,{rows:3})})}))})}else return null},[r,e]);return S(ue,{templateColumns:"repeat(1,1fr)",gap:5,children:[e&&e.length>0?a(B,{children:a(Z,{control:o,formState:t,name:"choosed",id:"choosed",rules:{required:{value:!0,message:"Dibutuhkan"}},children:a(Ht,{options:e.map(l=>({label:l.name,value:l.name})),direction:"column"})})}):a(B,{children:a(Z,{control:o,formState:t,name:"description",id:"description",label:"Deskripsi",rules:{required:{value:!0,message:"Dibutuhkan"}},children:a(me,{rows:3})})}),i,a(B,{children:a(Z,{control:o,formState:t,name:"keterangan",label:"Keterangan",id:"keterangan",children:a(me,{rows:5})})})]})},Kt=({editable:e=!1,data:o,onAnswer:t,initialValues:n={choosed:null,keterangan:null,attachment:void 0},isLoading:r=!1,getDetailLoading:i=!1})=>S(_.exports.Fragment,{children:[a(_t,{children:a(V,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:a(W,{fontWeight:"medium",fontSize:19,children:o.name})})}),S(le,{x:6,y:6,children:[i&&"Loading...",!i&&S(xe,{onSubmit:t,id:"form-question",initialValues:n,children:[a(Vt,{options:o.answers}),a(oe,{type:"submit",mt:5,isLoading:r,children:"Submit"})]})]})]}),$t=ne.forwardRef(({name:e,onChange:o,onBlur:t,value:n,placeholder:r},i)=>{const[l,c]=_.exports.useState(""),d=bt(l,1e3),{fetchNextPage:u,hasNextPage:s,isError:h,isSuccess:m,isLoading:v,data:x,isFetchingNextPage:P}=We(["fetch_select_users",d,n],({pageParam:f=1})=>Ct({current:f,search:d,value:n==null?void 0:n.value,pageSize:15}),{getNextPageParam:f=>Be(f),getPreviousPageParam:f=>Ue(f)}),g=xt({isSuccess:m,data:x!=null?x:{pages:[],pageParams:[]},key:"users",returnList:f=>({label:`${f.username} - ${f.full_name}`,value:f.id})});return a(Pt,{name:e,ref:i,onChange:o,onBlur:t,value:n,onInputChange:c,isLoading:P||v,isClearable:!0,noOptionsMessage:({inputValue:f})=>a("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:f})=>S(de,{children:[S("div",{children:['Mencari "',f,'"']}),v&&a(tt,{size:"xs",width:"100%",isIndeterminate:!0}),h&&a("div",{children:"Error saat mencari data"})]}),options:g,placeholder:a(W,{noOfLines:[1],children:r}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{s&&u()},closeMenuOnSelect:!0})}),Yt=()=>{const{control:e,formState:o}=_e();return S(ue,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(3,1fr)"},gap:4,children:[a(B,{children:a(Z,{placeholder:"-- Cari Pertanyaan --",control:e,name:"question_search",formState:o,id:"question_search",children:a(je,{})})}),a(B,{children:a(Z,{placeholder:"-- Pilih Status Pertanyaan --",control:e,name:"question_status",formState:o,id:"question_status",children:a(Se,{children:a(wt,{type_:"QUESTION_STATUS"})})})}),a(B,{children:a(Z,{placeholder:"-- Pilih Dijawab Siapa --",control:e,name:"question_answered_by",formState:o,id:"question_answered_by",children:a(Se,{children:a($t,{})})})})]})},Xt=({onSubmit:e})=>a(ye,{children:S(Ne,{children:[a(W,{fontWeight:"medium",mb:3,children:"Filter data"}),S(xe,{onSubmit:e,id:"form-questionaire",children:[a(Yt,{}),a(oe,{leftIcon:a(St,{}),mt:5,size:"sm",type:"submit",children:"Filter"})]})]})}),Ie="DESCRIPTION_ANSWERED";var $e={exports:{}};/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function te(e,o,t){this.x=e,this.y=o,this.time=t||new Date().getTime()}te.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};te.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};te.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function be(e,o,t,n){this.startPoint=e,this.control1=o,this.control2=t,this.endPoint=n}be.prototype.length=function(){for(var e=10,o=0,t=void 0,n=void 0,r=0;r<=e;r+=1){var i=r/e,l=this._point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this._point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(r>0){var d=l-t,u=c-n;o+=Math.sqrt(d*d+u*u)}t=l,n=c}return o};be.prototype._point=function(e,o,t,n,r){return o*(1-e)*(1-e)*(1-e)+3*t*(1-e)*(1-e)*e+3*n*(1-e)*e*e+r*e*e*e};function Jt(e,o,t){var n,r,i,l=null,c=0;t||(t={});var d=function(){c=t.leading===!1?0:Date.now(),l=null,i=e.apply(n,r),l||(n=r=null)};return function(){var u=Date.now();!c&&t.leading===!1&&(c=u);var s=o-(u-c);return n=this,r=arguments,s<=0||s>o?(l&&(clearTimeout(l),l=null),c=u,i=e.apply(n,r),l||(n=r=null)):!l&&t.trailing!==!1&&(l=setTimeout(d,s)),i}}function E(e,o){var t=this,n=o||{};this.velocityFilterWeight=n.velocityFilterWeight||.7,this.minWidth=n.minWidth||.5,this.maxWidth=n.maxWidth||2.5,this.throttle="throttle"in n?n.throttle:16,this.minDistance="minDistance"in n?n.minDistance:5,this.throttle?this._strokeMoveUpdate=Jt(E.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=E.prototype._strokeUpdate,this.dotSize=n.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=n.penColor||"black",this.backgroundColor=n.backgroundColor||"rgba(0,0,0,0)",this.onBegin=n.onBegin,this.onEnd=n.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(r){r.which===1&&(t._mouseButtonDown=!0,t._strokeBegin(r))},this._handleMouseMove=function(r){t._mouseButtonDown&&t._strokeMoveUpdate(r)},this._handleMouseUp=function(r){r.which===1&&t._mouseButtonDown&&(t._mouseButtonDown=!1,t._strokeEnd(r))},this._handleTouchStart=function(r){if(r.targetTouches.length===1){var i=r.changedTouches[0];t._strokeBegin(i)}},this._handleTouchMove=function(r){r.preventDefault();var i=r.targetTouches[0];t._strokeMoveUpdate(i)},this._handleTouchEnd=function(r){var i=r.target===t._canvas;i&&(r.preventDefault(),t._strokeEnd(r))},this.on()}E.prototype.clear=function(){var e=this._ctx,o=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,o.width,o.height),e.fillRect(0,0,o.width,o.height),this._data=[],this._reset(),this._isEmpty=!0};E.prototype.fromDataURL=function(e){var o=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new Image,r=t.ratio||window.devicePixelRatio||1,i=t.width||this._canvas.width/r,l=t.height||this._canvas.height/r;this._reset(),n.src=e,n.onload=function(){o._ctx.drawImage(n,0,0,i,l)},this._isEmpty=!1};E.prototype.toDataURL=function(e){var o;switch(e){case"image/svg+xml":return this._toSVG();default:for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(o=this._canvas).toDataURL.apply(o,[e].concat(n))}};E.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};E.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};E.prototype.isEmpty=function(){return this._isEmpty};E.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};E.prototype._strokeUpdate=function(e){var o=e.clientX,t=e.clientY,n=this._createPoint(o,t),r=this._data[this._data.length-1],i=r&&r[r.length-1],l=i&&n.distanceTo(i)<this.minDistance;if(!(i&&l)){var c=this._addPoint(n),d=c.curve,u=c.widths;d&&u&&this._drawCurve(d,u.start,u.end),this._data[this._data.length-1].push({x:n.x,y:n.y,time:n.time,color:this.penColor})}};E.prototype._strokeEnd=function(e){var o=this.points.length>2,t=this.points[0];if(!o&&t&&this._drawDot(t),t){var n=this._data[this._data.length-1],r=n[n.length-1];t.equals(r)||n.push({x:t.x,y:t.y,time:t.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};E.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};E.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};E.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};E.prototype._createPoint=function(e,o,t){var n=this._canvas.getBoundingClientRect();return new te(e-n.left,o-n.top,t||new Date().getTime())};E.prototype._addPoint=function(e){var o=this.points,t=void 0;if(o.push(e),o.length>2){o.length===3&&o.unshift(o[0]),t=this._calculateCurveControlPoints(o[0],o[1],o[2]);var n=t.c2;t=this._calculateCurveControlPoints(o[1],o[2],o[3]);var r=t.c1,i=new be(o[1],n,r,o[2]),l=this._calculateCurveWidths(i);return o.shift(),{curve:i,widths:l}}return{}};E.prototype._calculateCurveControlPoints=function(e,o,t){var n=e.x-o.x,r=e.y-o.y,i=o.x-t.x,l=o.y-t.y,c={x:(e.x+o.x)/2,y:(e.y+o.y)/2},d={x:(o.x+t.x)/2,y:(o.y+t.y)/2},u=Math.sqrt(n*n+r*r),s=Math.sqrt(i*i+l*l),h=c.x-d.x,m=c.y-d.y,v=s/(u+s),x={x:d.x+h*v,y:d.y+m*v},P=o.x-x.x,g=o.y-x.y;return{c1:new te(c.x+P,c.y+g),c2:new te(d.x+P,d.y+g)}};E.prototype._calculateCurveWidths=function(e){var o=e.startPoint,t=e.endPoint,n={start:null,end:null},r=this.velocityFilterWeight*t.velocityFrom(o)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(r);return n.start=this._lastWidth,n.end=i,this._lastVelocity=r,this._lastWidth=i,n};E.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};E.prototype._drawPoint=function(e,o,t){var n=this._ctx;n.moveTo(e,o),n.arc(e,o,t,0,2*Math.PI,!1),this._isEmpty=!1};E.prototype._drawCurve=function(e,o,t){var n=this._ctx,r=t-o,i=Math.floor(e.length());n.beginPath();for(var l=0;l<i;l+=1){var c=l/i,d=c*c,u=d*c,s=1-c,h=s*s,m=h*s,v=m*e.startPoint.x;v+=3*h*c*e.control1.x,v+=3*s*d*e.control2.x,v+=u*e.endPoint.x;var x=m*e.startPoint.y;x+=3*h*c*e.control1.y,x+=3*s*d*e.control2.y,x+=u*e.endPoint.y;var P=o+u*r;this._drawPoint(v,x,P)}n.closePath(),n.fill()};E.prototype._drawDot=function(e){var o=this._ctx,t=typeof this.dotSize=="function"?this.dotSize():this.dotSize;o.beginPath(),this._drawPoint(e.x,e.y,t),o.closePath(),o.fill()};E.prototype._fromData=function(e,o,t){for(var n=0;n<e.length;n+=1){var r=e[n];if(r.length>1)for(var i=0;i<r.length;i+=1){var l=r[i],c=new te(l.x,l.y,l.time),d=l.color;if(i===0)this.penColor=d,this._reset(),this._addPoint(c);else if(i!==r.length-1){var u=this._addPoint(c),s=u.curve,h=u.widths;s&&h&&o(s,h,d)}}else{this._reset();var m=r[0];t(m)}}};E.prototype._toSVG=function(){var e=this,o=this._data,t=this._canvas,n=Math.max(window.devicePixelRatio||1,1),r=0,i=0,l=t.width/n,c=t.height/n,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"width",t.width),d.setAttributeNS(null,"height",t.height),this._fromData(o,function(f,I,z){var R=document.createElement("path");if(!isNaN(f.control1.x)&&!isNaN(f.control1.y)&&!isNaN(f.control2.x)&&!isNaN(f.control2.y)){var k="M "+f.startPoint.x.toFixed(3)+","+f.startPoint.y.toFixed(3)+" "+("C "+f.control1.x.toFixed(3)+","+f.control1.y.toFixed(3)+" ")+(f.control2.x.toFixed(3)+","+f.control2.y.toFixed(3)+" ")+(f.endPoint.x.toFixed(3)+","+f.endPoint.y.toFixed(3));R.setAttribute("d",k),R.setAttribute("stroke-width",(I.end*2.25).toFixed(3)),R.setAttribute("stroke",z),R.setAttribute("fill","none"),R.setAttribute("stroke-linecap","round"),d.appendChild(R)}},function(f){var I=document.createElement("circle"),z=typeof e.dotSize=="function"?e.dotSize():e.dotSize;I.setAttribute("r",z),I.setAttribute("cx",f.x),I.setAttribute("cy",f.y),I.setAttribute("fill",f.color),d.appendChild(I)});var u="data:image/svg+xml;base64,",s='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+r+" "+i+" "+l+" "+c+'"')+(' width="'+l+'"')+(' height="'+c+'"')+">",h=d.innerHTML;if(h===void 0){var m=document.createElement("dummy"),v=d.childNodes;m.innerHTML="";for(var x=0;x<v.length;x+=1)m.appendChild(v[x].cloneNode(!0));h=m.innerHTML}var P="</svg>",g=s+h+P;return u+btoa(g)};E.prototype.fromData=function(e){var o=this;this.clear(),this._fromData(e,function(t,n){return o._drawCurve(t,n.start,n.end)},function(t){return o._drawDot(t)}),this._data=e};E.prototype.toData=function(){return this._data};const Zt=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"})),en=nt(Zt);var ge={exports:{}},Re;function tn(){return Re||(Re=1,function(e,o){(function(t,n){e.exports=n()})(qe,function(){return function(t){function n(i){if(r[i])return r[i].exports;var l=r[i]={exports:{},id:i,loaded:!1};return t[i].call(l.exports,l,l.exports,n),l.loaded=!0,l.exports}var r={};return n.m=t,n.c=r,n.p="",n(0)}([function(t,n){function r(u){var s=u.getContext("2d"),h=u.width,m=u.height,v=s.getImageData(0,0,h,m).data,x=c(!0,h,m,v),P=c(!1,h,m,v),g=d(!0,h,m,v),f=d(!1,h,m,v),I=f-g+1,z=P-x+1,R=s.getImageData(g,x,I,z);return u.width=I,u.height=z,s.clearRect(0,0,I,z),s.putImageData(R,0,0),u}function i(u,s,h,m){return{red:m[4*(h*s+u)],green:m[4*(h*s+u)+1],blue:m[4*(h*s+u)+2],alpha:m[4*(h*s+u)+3]}}function l(u,s,h,m){return i(u,s,h,m).alpha}function c(u,s,h,m){for(var v=u?1:-1,x=u?0:h-1,P=x;u?P<h:P>-1;P+=v)for(var g=0;g<s;g++)if(l(g,P,s,m))return P;return null}function d(u,s,h,m){for(var v=u?1:-1,x=u?0:s-1,P=x;u?P<s:P>-1;P+=v)for(var g=0;g<h;g++)if(l(P,g,s,m))return P;return null}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r}])})}(ge)),ge.exports}(function(e,o){(function(t,n){e.exports=n(qt.exports,_.exports,en,tn())})(qe,function(t,n,r,i){return function(l){function c(u){if(d[u])return d[u].exports;var s=d[u]={exports:{},id:u,loaded:!1};return l[u].call(s.exports,s,s.exports,c),s.loaded=!0,s.exports}var d={};return c.m=l,c.c=d,c.p="",c(0)}([function(l,c,d){function u(b){return b&&b.__esModule?b:{default:b}}function s(b,y){var D={};for(var w in b)y.indexOf(w)>=0||Object.prototype.hasOwnProperty.call(b,w)&&(D[w]=b[w]);return D}function h(b,y){if(!(b instanceof y))throw new TypeError("Cannot call a class as a function")}function m(b,y){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?b:y}function v(b,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);b.prototype=Object.create(y&&y.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(b,y):b.__proto__=y)}Object.defineProperty(c,"__esModule",{value:!0});var x=Object.assign||function(b){for(var y=1;y<arguments.length;y++){var D=arguments[y];for(var w in D)Object.prototype.hasOwnProperty.call(D,w)&&(b[w]=D[w])}return b},P=function(){function b(y,D){for(var w=0;w<D.length;w++){var p=D[w];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(y,p.key,p)}}return function(y,D,w){return D&&b(y.prototype,D),w&&b(y,w),y}}(),g=d(1),f=u(g),I=d(2),z=u(I),R=d(3),k=u(R),M=d(4),N=u(M),L=function(b){function y(){var D,w,p,U;h(this,y);for(var X=arguments.length,Q=Array(X),J=0;J<X;J++)Q[J]=arguments[J];return w=p=m(this,(D=y.__proto__||Object.getPrototypeOf(y)).call.apply(D,[this].concat(Q))),p._sigPad=null,p._excludeOurProps=function(){var T=p.props,O=(T.canvasProps,T.clearOnResize,s(T,["canvasProps","clearOnResize"]));return O},p.getCanvas=function(){return p._canvas},p.getTrimmedCanvas=function(){var T=document.createElement("canvas");return T.width=p._canvas.width,T.height=p._canvas.height,T.getContext("2d").drawImage(p._canvas,0,0),(0,N.default)(T)},p.getSignaturePad=function(){return p._sigPad},p._checkClearOnResize=function(){p.props.clearOnResize&&p._resizeCanvas()},p._resizeCanvas=function(){var T=p.props.canvasProps||{},O=T.width,j=T.height;if(!O||!j){var G=p._canvas,K=Math.max(window.devicePixelRatio||1,1);O||(G.width=G.offsetWidth*K),j||(G.height=G.offsetHeight*K),G.getContext("2d").scale(K,K),p.clear()}},p.on=function(){return window.addEventListener("resize",p._checkClearOnResize),p._sigPad.on()},p.off=function(){return window.removeEventListener("resize",p._checkClearOnResize),p._sigPad.off()},p.clear=function(){return p._sigPad.clear()},p.isEmpty=function(){return p._sigPad.isEmpty()},p.fromDataURL=function(T,O){return p._sigPad.fromDataURL(T,O)},p.toDataURL=function(T,O){return p._sigPad.toDataURL(T,O)},p.fromData=function(T){return p._sigPad.fromData(T)},p.toData=function(){return p._sigPad.toData()},U=w,m(p,U)}return v(y,b),P(y,[{key:"componentDidMount",value:function(){this._sigPad=new k.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var D=this,w=this.props.canvasProps;return z.default.createElement("canvas",x({ref:function(p){D._canvas=p}},w))}}]),y}(I.Component);L.propTypes={velocityFilterWeight:f.default.number,minWidth:f.default.number,maxWidth:f.default.number,minDistance:f.default.number,dotSize:f.default.oneOfType([f.default.number,f.default.func]),penColor:f.default.string,throttle:f.default.number,onEnd:f.default.func,onBegin:f.default.func,canvasProps:f.default.object,clearOnResize:f.default.bool},L.defaultProps={clearOnResize:!0},c.default=L},function(l,c){l.exports=t},function(l,c){l.exports=n},function(l,c){l.exports=r},function(l,c){l.exports=i}])})})($e);const nn=ot($e.exports),on=_.exports.forwardRef(({},e)=>{const{formState:o,control:t}=_e();return S(de,{children:[a(Z,{control:t,formState:o,label:"PIC",name:"pic",id:"pic",rules:{required:{value:!0,message:"Dibutuhkan"}},children:a(je,{})}),S(ce,{mt:5,children:[S(V,{justifyContent:"space-between",alignItems:"center",children:[a(W,{fontSize:"xs",children:"*Input Tanda Tangan"}),a(oe,{variant:"link",size:"xs",onClick:()=>{var n;(n=e==null?void 0:e.current)==null||n.clear()},children:"Clear Signature"})]}),a(ce,{border:"1px solid black",children:a(nn,{penColor:"black",ref:e,canvasProps:{width:400,height:200,className:"sigCanvas"},backgroundColor:"#fff"})})]})]})}),rn=({projectId:e,structureId:o})=>{const t=_.exports.useRef(),n=Le(),r=ze(),i=Oe(),l=Qe(kt);return S(xe,{onSubmit:d=>{var u;l.mutate({projectId:e,structureId:o,pic:d.pic,signature:(u=t.current)==null?void 0:u.getTrimmedCanvas().toDataURL("image/png")},{onSuccess:s=>{r({status:"success",title:"success",description:s.message,position:"top",isClosable:!0}),i.invalidateQueries(["detail_structure"]),n(De())},onError:s=>Ge(s,r)})},id:"form-submit",children:[a(ce,{p:5,children:a(on,{ref:t})}),a(Lt,{children:S(V,{gap:5,alignItems:"center",children:[a(oe,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>{n(De())},children:"Close"}),a(oe,{size:"sm",type:"submit",isLoading:l.isLoading,children:"Submit"})]})})]})},Hn=_.exports.forwardRef(({structuresId:e,projectId:o,editable:t=!1},n)=>{var j,G,K,re,ie;const r=Le(),[i,l]=_.exports.useState(e),[c,d]=_.exports.useState(o),[u]=rt(),[s,h]=_.exports.useState(null),[m,v]=_.exports.useState({question_answered_by:null,question_search:null,question_status:null});_.exports.useImperativeHandle(n,()=>({removeFilterQuestions(){v({question_answered_by:null,question_search:null,question_status:null}),h(null)}}));const x=ze(),P=Oe(),g=Qe(Et);_.exports.useEffect(()=>{d(o!=null?o:+u.get("projectId")),l(e!=null?e:u.get("structureId"))},[e,u.get("structureId"),o,u.get("projectId")]);const{isSuccess:f,isLoading:I,isError:z,data:R}=we(["detail_structure",i,c],()=>Dt({structureId:i,projectId:c}),{enabled:!!i&&!!c}),{isSuccess:k,isLoading:M,isError:N,refetch:L,data:b,hasNextPage:y,fetchNextPage:D}=We(["questions",i,c,{...m}],({pageParam:C=1})=>Ft({id:i,prjId:c,current:C,answered_by:m.question_answered_by,status_answered:m.question_status,search:m.question_search,pageSize:15}),{enabled:!!i,getNextPageParam:C=>Be(C),getPreviousPageParam:C=>Ue(C)}),{data:w,isLoading:p,isSuccess:U}=we(["answered_question",s==null?void 0:s.id],()=>Rt(s==null?void 0:s.id),{cacheTime:0,staleTime:0,enabled:!!(s!=null&&s.id)}),X=_.exports.useMemo(()=>{let C={};return U?(w.data.conditions&&w.data.conditions.map(q=>{C[q.label]=q.value}),w.data.answer_label===Ie?{description:w.data.description,keterangan:w.data.note,attachment:void 0,...C}:{choosed:w.data.answer_label,keterangan:w.data.note,attachment:void 0,...C}):{choosed:null,keterangan:null,attachment:void 0}},[U,w]),Q=C=>{var q,$;h(null),v({question_status:(q=C.question_status)==null?void 0:q.value,question_search:C.question_search,question_answered_by:($=C.question_answered_by)==null?void 0:$.value})},J=C=>{var pe;let q,$;C!=null&&C.choosed?($=s.answers.find(Y=>Y.name===C.choosed),q=$.conditions.map(Y=>({label:Y.name,value:C==null?void 0:C[Y.name]}))):q=null,g.mutate({answer:{conditions:q,keterangan:C.keterangan,label:(pe=C==null?void 0:C.choosed)!=null?pe:Ie,value:$?$.value.toString():C.description},question_id:s.id},{onSuccess:Y=>{x({position:"top",title:"Success",description:Y.message,isClosable:!0}),P.invalidateQueries(["statisic_project"]),P.invalidateQueries(["log_project"]),h(null),L()},onError:Y=>Ge(Y,x)})},T=C=>{h(C)},O=()=>{r(Tt(a(rn,{projectId:c,structureId:i}),"Edit PIC Questioner","md"))};return a(_.exports.Fragment,{children:N?a(Mt,{}):S(_.exports.Fragment,{children:[S(le,{x:0,y:2,children:[I&&a(zt,{w:"100%",h:100}),z&&a(W,{children:"Error Menampilkan Detail Struktur"}),f&&a(ye,{children:a(Ne,{children:S(V,{justifyContent:"space-between",alignItems:"center",children:[S(ue,{templateColumns:{base:"repeat(1,1fr)",lg:"repeat(3,1fr)"},flex:1,children:[a(B,{children:a(ae,{maxW:"100%",direction:"column",label:"Unit Kerja",value:R.data.name})}),a(B,{children:a(ae,{maxW:"100%",direction:"column",label:"Counterpart",value:(G=(j=R.data.questioner_info)==null?void 0:j[0])==null?void 0:G.pic})}),a(B,{children:a(ae,{maxW:"100%",direction:"column",label:"TTD Counterpart",value:a("img",{src:(re=(K=R.data.questioner_info)==null?void 0:K[0])==null?void 0:re.signature,style:{width:300,height:"auto"}})})})]}),t?a(he,{label:"Edit PIC",children:a(fe,{"aria-label":"Edit",onClick:O,variant:"unstyled",icon:a(Ee,{fontSize:28,color:"yellow.400"})})}):!R.data.questioner_info&&a(he,{label:"Edit PIC",children:a(fe,{"aria-label":"Edit",onClick:O,variant:"unstyled",icon:a(Ee,{fontSize:28,color:"yellow.400"})})})]})})})]}),a(le,{x:0,y:2,children:a(Xt,{onSubmit:Q})}),a(le,{x:0,y:3,children:a(ye,{children:S(ue,{templateColumns:"repeat(5,1fr)",children:[S(B,{colSpan:{base:5,lg:s?2:5},display:{base:s?"none":"block",lg:"block"},borderRight:{base:0,lg:.5},borderStyle:"solid",borderColor:"grey.200",maxH:{lg:700},minH:{base:700},overflowY:{lg:"auto"},_dark:{borderColor:"grey.600"},children:[M&&a(at,{}),k&&b.pages[0].questions&&((ie=b.pages[0].questions)==null?void 0:ie.length)>0?S(de,{children:[b.pages.map(C=>C.questions&&C.questions.length>0?a(de,{children:C.questions.map(q=>a(Gt,{question_title:q.name,onClick:()=>T(q),answered_at:q.answered_at,active:(s==null?void 0:s.id)===(q==null?void 0:q.id),answered_by_name:q.answered_by_name,answered_by_profile:q.answered_by_profile}))}):a(ke,{})),y&&a(V,{my:5,justifyContent:"center",children:a(oe,{size:"sm",onClick:()=>D(),children:"Load More"})})]}):a(V,{alignItems:"center",justifyContent:"center",h:"100%",children:a(ke,{})})]}),s&&S(B,{colSpan:{base:s?5:0,lg:3},display:{base:s?"block":"none",lg:"block"},children:[a(fe,{"aria-label":"Comeback",display:{base:"block",lg:"none"},variant:"link",fontSize:28,onClick:()=>h(null),icon:a(It,{}),ml:5,mt:5}),a(Kt,{editable:t,data:s,onAnswer:J,initialValues:X,getDetailLoading:p,isLoading:g.isLoading})]})]})})})]})})});export{Hn as default};
