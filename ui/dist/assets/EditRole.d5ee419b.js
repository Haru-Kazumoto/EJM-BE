import{aS as C,a4 as v,c as P,ac as j,f as y,r as M,j as l,a as n,g as x}from"./index.5b816863.js";import{a as B,P as D}from"./PagePadding.45875137.js";import{P as L}from"./PageHeader.d27f8ae4.js";import{a as N}from"./FormFieldControl.83524802.js";import{u as T,C as c,F as A}from"./FormFieldRole.e6b1f2ca.js";import{S as F}from"./SaveIcon.9e5414f7.js";import{b as H,u as _}from"./rolesActions.68ced932.js";import{u as k,E as K}from"./useError.d999dd2c.js";import{B as O}from"./index.esm.f21969b8.js";import"./ArrowLeftIcon.5e09b122.js";import"./FieldText.51c97a45.js";import"./index.esm.9250e631.js";import"./FieldCustom.e664487c.js";import"./FieldSwitch.f5382b97.js";import"./index.esm.10c6c73a.js";import"./index.238261e4.js";const se=()=>{var E,I;const{items:i,isLoading:b,isSuccess:d}=T(),{id:m}=C(),p=v(),h=P(),R=j(),{data:t,isLoading:f,isSuccess:s}=y(["detail_role",m],()=>H(+m),{enabled:!!m,keepPreviousData:!1,cacheTime:0,refetchOnWindowFocus:!1,refetchIntervalInBackground:!1,refetchOnMount:!1,refetchOnReconnect:!1}),g=k(_),S=a=>{let r=[];a.menus.filter(e=>e.type==="menu"&&(e.state===c.CHECKED||e.state===c.INDETERMINATE)).map(e=>{r.push({menuId:e.id,apiId:a.menus.filter(o=>o.type==="api"&&o.parentId===e.id&&(o.state===c.CHECKED||o.state===c.INDETERMINATE)).map(o=>o.id)})}),g.mutate({id:m,name:a.name,active:a.active,actionApi:r,objectActions:a.menus},{onSuccess:e=>{p({title:"Success",description:e.message,position:"top",status:"success",isClosable:!0}),R.invalidateQueries(["roles"]),h("/management/roles")},onError:e=>K(e,p)})},u=M.exports.useMemo(()=>s&&t.data.object_menus&&t.data.object_menus.length>0?i.map(a=>{var r;return{...a,state:(r=t.data.object_menus.find(e=>e.id===a.id).state)!=null?r:c.UNCHECKED}}):i,[t,s,d,i,f,s]);return l(B,{title:`Edit Role ${(E=s&&t.data.name)!=null?E:"-"}`,children:[n(L,{label:`Edit Role ${(I=s&&t.data.name)!=null?I:"-"}`,useBackButton:!0}),l(D,{x:6,children:[f||b&&n(x,{}),s&&d&&u&&u.length>0&&l(N,{onSubmit:S,id:"form-role",initialValues:{name:t.data.name,active:t.data.is_active,menus:u},children:[n(A,{items:i}),n(O,{type:"submit",mt:5,leftIcon:n(F,{}),isLoading:g.isLoading,children:"Submit"})]})]})]})};export{se as default};
