import{P as S}from"./Page.ce903aa1.js";import{P as b}from"./PageHeader.954bf5c1.js";import{P as m}from"./PagePadding.8c1b0086.js";import{a as P}from"./FormFieldControl.b614070a.js";import{F as h,a as F}from"./FormFieldCompanyStructure.04f80633.js";import{S as j}from"./SaveIcon.2cbae624.js";import{u as v,b as x}from"./companyActions.f4866318.js";import{u as D,E as f}from"./useError.46aba7e3.js";import{a4 as I,aT as B,c as L,ae as Q,f as _,j as u,a as e,g as N,D as y}from"./index.4df5dae3.js";import{E as T}from"./ErrorFetching.5d5f8a6b.js";import{B as k}from"./index.esm.780dcd2c.js";import"./ArrowLeftIcon.0c9057ff.js";import"./FieldText.6d44809e.js";import"./FileIcon.a3943f0b.js";import"./FieldSelect.70d2789f.js";import"./select.0fe29549.js";import"./slicedToArray.556cd5c1.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./index.esm.f3b9d19a.js";import"./AddIcon.159dfaf4.js";import"./DeleteIcon.8cd44a6f.js";import"./useTranslation.d56b7bba.js";const at=()=>{const n=D(v),a=I(),{id:o}=B(),c=L(),p=Q(),{data:d,isLoading:g,isSuccess:C,isError:E}=_(["detail_company",o],()=>x(+o),{enabled:!!o,cacheTime:0});return u(S,{title:"Edit Company",children:[e(b,{useBackButton:!0,label:"Edit Company"}),u(m,{x:6,children:[g&&e(N,{}),E&&e(T,{}),C&&u(P,{onSubmit:r=>{const l=r.structures&&r.structures.length>0?r.structures.map(t=>{var s;return{id:t.id,structureCode:t.structureCode,name:(s=t.structureName)!=null?s:t.name,parentId:`${t.parentId}`}}):[];if(!r.picture)n.mutate({id:o,payload:{...r,object_structures:l}},{onSuccess:t=>{a({title:"Success",description:t.message,position:"top",status:"success",isClosable:!0}),p.invalidateQueries(["companies"]),c("/master/companies")},onError:t=>f(t,a)});else{const t=new FormData;for(const[s,i]of Object.entries(r))s==="picture"?t.append("file",i==null?void 0:i[0]):s==="structures"?t.append("object_structures_string",JSON.stringify(l)):t.append(s,i);n.mutate({id:o,payload:t},{onSuccess:s=>{a({title:"Success",description:s.message,position:"top",status:"success",isClosable:!0}),p.invalidateQueries(["companies"]),c("/master/companies")},onError:s=>f(s,a)})}},id:"form-company",initialValues:{name:d.data.name,picture:null,structures:d.data.structures},children:[e(h,{}),e(m,{x:0,y:5,children:e(y,{})}),e(F,{}),e(m,{x:0,y:5,children:e(y,{})}),e(k,{mt:5,leftIcon:e(j,{}),type:"submit",isLoading:n.isLoading,children:"Save"})]})]})]})};export{at as default};
