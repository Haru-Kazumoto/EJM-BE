import{j as t,I as be,a as e,R as Se,r as L,h as M,an as Ce,T as _,d as F,a4 as H,ac as Z,f as J,B as P,F as h,c as je,aq as K,ar as A,aO as te,aP as ne,aQ as Te,u as Fe,aR as we,aS as Ne,g as pe,aj as me}from"./index.5b816863.js";import{a as Oe,P as Qe}from"./PagePadding.45875137.js";import{P as Re}from"./PageHeader.d27f8ae4.js";import{A as ve}from"./AddIcon.165e61b5.js";import{E as se}from"./EditIcon.22244ff4.js";import{D as w}from"./Detailinformation.a10fd27e.js";import{B as Ve}from"./BuildingIcon.b8d19652.js";import{C as Be,F as He}from"./FormFieldProject.04bdf283.js";import{U as qe}from"./UserIcon.2084c42a.js";import{d as ie}from"./dayjs.min.8382c62a.js";import{r as $e}from"./relativeTime.3d17f6ee.js";import{D as _e}from"./DeleteIcon.aa14c306.js";import{E as Ge}from"./EyeIcon.2711c0d0.js";import{c as T,o as Q,a as Pe}from"./uiActions.07096468.js";import{S as X}from"./SearchInput.8904345c.js";import{a as oe,S as We,u as Ye,b as Je,d as Ke,c as Ze,e as Xe,s as er,f as rr,h as tr,i as nr,j as ir}from"./projectActions.1197d90c.js";import{u as V}from"./useDebounce.b2496c93.js";import{u as q,a as $}from"./useSelectDataMapper.1d7decc0.js";import{C as ye}from"./ConfirmDelete.42e62056.js";import{u as sr,F as he,a as ae}from"./FormFieldControl.83524802.js";import{G as ke,a as xe}from"./useGetPrevPageParam.cb1386c2.js";import{S as Ie}from"./select.c640a523.js";import{F as ge}from"./FieldCustom.e664487c.js";import{S as Ae}from"./SaveIcon.9e5414f7.js";import{u as R,E as O}from"./useError.d999dd2c.js";import{f as ee}from"./index.esm.5601fbef.js";import{B as E,I as U}from"./index.esm.f21969b8.js";import{A as re,a as or}from"./index.esm.70bdc104.js";import{C as le,c as ce,a as de}from"./index.esm.1375edc3.js";import{T as N}from"./index.esm.089565e5.js";import{E as Le}from"./ErrorFetching.2a6dc88b.js";import{E as B}from"./ErrorEmpty.180e4712.js";import{a as ar,C as ue}from"./index.esm.10c6c73a.js";import{F as lr,a as cr,I as dr,c as ur,f as pr,g as mr}from"./index.esm.9250e631.js";import{g as hr}from"./questionActions.98bb3067.js";import{S as De}from"./index.esm.c26f097d.js";import{e as gr}from"./usersActions.cd3a8c1d.js";import{T as fr,a as br,b as G,c as Sr,d as W}from"./index.esm.03dbf1d9.js";import"./ArrowLeftIcon.5e09b122.js";import"./FieldText.51c97a45.js";import"./slicedToArray.01f71b8b.js";import"./FieldTextArea.7018b180.js";import"./useTranslation.6be11027.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./index.esm.7f1cbbdf.js";import"./index.esm.28b35340.js";import"./inheritsLoose.ae32a3c5.js";import"./index.238261e4.js";const Y=({...r})=>t(be,{...r,children:[e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 5C3 4.44772 3.44772 4 4 4H16C16.5523 4 17 4.44772 17 5C17 5.55228 16.5523 6 16 6H4C3.44772 6 3 5.55228 3 5Z",fill:"currentColor"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 10C3 9.44772 3.44772 9 4 9H16C16.5523 9 17 9.44772 17 10C17 10.5523 16.5523 11 16 11H4C3.44772 11 3 10.5523 3 10Z",fill:"currentColor"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 15C9 14.4477 9.44772 14 10 14H16C16.5523 14 17 14.4477 17 15C17 15.5523 16.5523 16 16 16H10C9.44772 16 9 15.5523 9 15Z",fill:"currentColor"})]}),Cr=Se.forwardRef(({name:r,onChange:a,onBlur:o,value:i,placeholder:c,projectId:p,isMulti:S=!1},g)=>{const[d,u]=L.exports.useState(""),j=V(d,1e3),{fetchNextPage:b,hasNextPage:C,isError:y,isSuccess:n,isLoading:I,data:k}=q(["fetch_select_structure_by_project_primitive",j,p],({pageParam:v=1})=>oe({current:v,search:j,value:i==null?void 0:i.value,project:+p,pageSize:15}),{enabled:!!p,refetchOnMount:!1,refetchOnWindowFocus:!1,getNextPageParam:v=>ke(v),getPreviousPageParam:v=>xe(v)}),f=$({isSuccess:n,data:k!=null?k:{pages:[],pageParams:[]},key:"structures",returnList:v=>({label:v.name,value:v.uuid})});return e(Ie,{name:r,ref:g,onChange:a,onBlur:o,value:i,isMulti:S,onInputChange:u,isLoading:I,isClearable:!0,noOptionsMessage:({inputValue:v})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:v})=>t(M,{children:[t("div",{children:['Mencari "',v,'"']}),I&&e(Ce,{size:"xs",width:"100%",isIndeterminate:!0}),y&&e("div",{children:"Error saat mencari data"})]}),options:f,placeholder:e(_,{noOfLines:[1],children:c}),closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{C&&b()},closeMenuOnSelect:!0})}),Ee=({project_id:r})=>{const{control:a,formState:o}=sr();return t(M,{children:[e(he,{control:a,name:"job",formState:o,id:"job",placeholder:"-- Pilih Pekerjaan --",rules:{required:{value:!0,message:"Dibutuhkan"},min:{value:1,message:"Dibutuhkan"}},children:e(ge,{children:e(We,{type_:"PROJECT_JOB",isMulti:!0})})}),e(he,{control:a,name:"unit_kerja",formState:o,id:"unit_kerja",placeholder:"-- Pilih Unit Kerja --",rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(ge,{children:e(Cr,{projectId:r,isMulti:!0})})})]})},jr=({project_id:r,user_id:a})=>{const o=F(),i=H(),c=Z(),p=R(Ye),{data:S,isLoading:g,isError:d,isSuccess:u}=J(["detail_assigned_user",r,a],()=>Je({projectId:r,userId:a}),{enabled:!!r&&!!a,cacheTime:0,onError:b=>O(b,i)});return t(M,{children:[d&&e(P,{p:5,children:"Error"}),g&&e(P,{p:5,children:"Loading..."}),u&&t(ae,{onSubmit:b=>{const C=b.job.map(n=>n.value),y=b.unit_kerja.map(n=>n.value);p.mutate({userId:a,payload:{project_id:+r,job:C,structure_id:y}},{onSuccess:n=>{i({status:"success",title:"success",description:n.message,position:"top",isClosable:!0}),c.invalidateQueries(["project_detail"]),c.invalidateQueries(["users_assigned"]),o(T())},onError:n=>O(n,i)})},id:"form-edit-assign-user",initialValues:{job:S.data.job,unit_kerja:S.data.structures},children:[e(P,{p:5,children:e(h,{gap:5,flexDirection:"column",children:e(Ee,{project_id:r})})}),e(ee,{children:t(h,{gap:5,children:[e(E,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>o(T()),children:"Cancel"}),e(E,{type:"submit",variant:"solid",isLoading:p.isLoading,size:"sm",leftIcon:e(Ae,{}),children:"Submit"})]})})]})]})},ze=({project_id:r})=>{const[a,o]=L.exports.useState();je();const i=F(),c=H(),p=Z(),S=V(a,200),g=R(Ke),{data:d,isLoading:u,isSuccess:j,isError:b,isFetchingNextPage:C,hasNextPage:y,fetchNextPage:n}=q(["assign_users_paginated",S,r],({pageParam:s})=>Ze({pageSize:20,current:s,search:S,project_id:r})),I=s=>{g.mutate({id:s,projectId:+r},{onSuccess:x=>{c({status:"success",title:"Sukses",description:x.message,position:"top",isClosable:!0}),p.invalidateQueries(["project_detail"]),p.invalidateQueries(["users_assigned"]),i(T())},onError:x=>O(x,c)})},k=s=>{i(Q(e(ye,{onDelete:()=>I(s)}),"Anda yakin ingin menghapus data ini ?","md"))},f=s=>{i(Q(e(jr,{project_id:r,user_id:s}),"Edit User","md"))},v=$({isSuccess:j,data:d!=null?d:{pages:[],pageParams:[]},key:"users",filterFn:s=>s.roleId!==1,returnList:s=>{var x,D;return t(h,{justifyContent:"space-between",alignItems:"center",children:[t(h,{gap:2,alignItems:"center",children:[e(re,{size:"xs",objectFit:"cover",name:(x=s.full_name)!=null?x:"",src:s.profile_pict?`/api/v1/profiles/${s.profile_pict}`:"/default-image.jpg"}),e(_,{fontSize:"sm",children:(D=s.full_name)!=null?D:""})]}),t(P,{children:[e(U,{"aria-label":"Edit Assigned User",fontSize:20,color:"yellow.500",variant:"link",onClick:()=>f(s.id),icon:e(se,{})}),e(U,{"aria-label":"Delete Assigned User",fontSize:20,color:"red.500",variant:"link",onClick:()=>k(s.id),icon:e(_e,{})})]})]})}});return e(P,{p:5,children:t(h,{flexDirection:"column",gap:5,children:[e(X,{onChange:s=>{s.preventDefault(),o(s.target.value)}}),b&&"Error Occured",u&&"Loading..",j&&t(h,{flexDirection:"column",gap:2,maxH:300,overflowY:"auto",children:[v,y&&e(E,{size:"sm",mt:2,onClick:()=>n(),isLoading:C,children:"Load More"})]})]})})};ie.extend($e);const vr=({data:r,onDelete:a,onEdit:o})=>{const i=F(),c=()=>{i(Pe({component:e(ze,{project_id:r.id}),title:"List Assigned User",size:"md"}))};return t(le,{children:[e(ce,{children:t(h,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:[e(_,{fontWeight:"medium",fontSize:19,children:"Project Info"}),t(h,{alignItems:"center",gap:2,children:[e(N,{label:"Edit Project Info",children:e(U,{"aria-label":"Edit",variant:"unstyled",onClick:o,icon:e(se,{fontSize:28,color:"yellow.400"})})}),e(N,{label:"Delete Project",children:e(U,{"aria-label":"Delete",variant:"unstyled",onClick:a,icon:e(_e,{fontSize:28,color:"red.400"})})})]})]})}),e(de,{children:t(K,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)",xl:"repeat(3,1fr)"},gap:{base:5,md:2},children:[e(A,{children:e(w,{leftIcon:e(Ve,{fontSize:21}),label:"Company",value:t(h,{gap:2,alignItems:"center",children:[e(re,{size:"xs",objectFit:"cover",name:r.company.name,src:r.company.profile_pict?`/api/v1/profiles/${r.company.profile_pict}`:"/default-image.jpg"}),e(_,{fontSize:12,children:r.company.name})]}),direction:"column"})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Type",direction:"column",value:r.select_project_type_label})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Status",direction:"column",value:r.select_status_label})}),e(A,{children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Project Code",direction:"column",value:r.project_code})}),e(A,{children:e(w,{leftIcon:e(Be,{fontSize:21}),label:"Due Date",direction:"column",value:t("div",{children:[e(_,{children:ie(r.project_date).format("DD MMMM YYYY")}),t("small",{children:["(",ie(r.project_date).fromNow(),")"]})]})})}),e(A,{children:e(w,{leftIcon:e(qe,{fontSize:21}),label:"Assigned User",direction:"column",value:t(h,{gap:2,alignItems:"center",children:[e(_,{children:r.total_assigned_users.toString()}),e(N,{label:"Click to view Detail",children:e(U,{"aria-label":"Detail",variant:"link",onClick:c,icon:e(Ge,{})})})]})})}),e(A,{colSpan:{base:0,xl:3},children:e(w,{leftIcon:e(Y,{fontSize:21}),label:"Description",direction:"column",value:r.description})})]})})]})},_r=()=>t(le,{children:[e(ce,{children:e(_,{fontWeight:"medium",fontSize:19,children:"Task Progress"})}),e(de,{children:t(K,{templateColumns:{base:"repeat(1,1fr)",xl:"repeat(3,1fr)"},gap:5,children:[e(A,{children:t(h,{flexDirection:"column",alignItems:"center",children:[t("div",{style:{marginBottom:2},children:[e(_,{children:"Questionaire"}),e("small",{children:"( 10 / 210 )"})]}),e(P,{children:e(te,{value:40,color:"green.400",size:150,children:e(ne,{children:"40%"})})})]})}),e(A,{children:t(h,{flexDirection:"column",alignItems:"center",children:[t("div",{style:{marginBottom:2},children:[e(_,{children:"Inventory"}),e("small",{children:"( 10 / 50 )"})]}),e(P,{children:e(te,{value:20,color:"green.400",size:150,children:e(ne,{children:"20%"})})})]})}),e(A,{children:t(h,{flexDirection:"column",alignItems:"center",children:[t("div",{style:{marginBottom:2},children:[e(_,{children:"Volumes"}),e("small",{children:"( 5 / 10 )"})]}),e(P,{children:e(te,{value:10,color:"green.400",size:150,children:e(ne,{children:"10%"})})})]})})]})})]}),Me=(r="id",a="parentId",o,i="0")=>o.filter(c=>c[a]===i).map(c=>({...c,children:Me(r,a,o,c[r])})),Ue=({id:r,placeholder:a,label:o,isRequired:i=!1,errorMessage:c,type:p="text",leftElement:S,rightElement:g,isInvalid:d=!1,formState:u,direction:j="row",options:b,...C})=>t(lr,{isRequired:i,isInvalid:d,children:[o&&o!==""?e(cr,{htmlFor:r,children:o}):null,t(dr,{children:[S&&e(ur,{pointerEvents:"none",alignItems:"center",children:S}),e(ar,{...C,children:e(Te,{direction:j,children:b&&b.length>0?b.map(y=>e(ue,{value:y.value,children:y.label})):null})}),g&&e(pr,{alignItems:"center",children:g})]}),e(mr,{children:c})]}),Pr=Se.forwardRef(({name:r,onChange:a,onBlur:o,value:i,placeholder:c},p)=>{const[S,g]=L.exports.useState(""),d=V(S,1e3),{fetchNextPage:u,hasNextPage:j,isError:b,isSuccess:C,isLoading:y,data:n,isFetchingNextPage:I}=q(["fetch_select_question_templates",d],({pageParam:f=1})=>hr({current:f,search:d,value:i==null?void 0:i.value,using_active:!0,pageSize:15}),{getNextPageParam:f=>ke(f),getPreviousPageParam:f=>xe(f)}),k=$({isSuccess:C,data:n!=null?n:{pages:[],pageParams:[]},key:"question_templates",returnList:f=>({label:f.name,value:f.id})});return e(Ie,{name:r,ref:p,onChange:a,onBlur:o,value:i,onInputChange:g,isLoading:I||y,isClearable:!0,noOptionsMessage:({inputValue:f})=>e("div",{children:"Tidak ada pilihan"}),loadingMessage:({inputValue:f})=>t(M,{children:[t("div",{children:['Mencari "',f,'"']}),y&&e(Ce,{size:"xs",width:"100%",isIndeterminate:!0}),b&&e("div",{children:"Error saat mencari data"})]}),options:k,placeholder:c,closeMenuOnScroll:!0,isSearchable:!0,onMenuScrollToBottom:()=>{j&&u()},closeMenuOnSelect:!0})}),yr=({projectId:r})=>{const[a,o]=L.exports.useState(),[i,c]=L.exports.useState([]),[p,S]=L.exports.useState(null),g=H(),d=F(),u=V(a,200),j=R(Xe),b=Z(),{data:C,isLoading:y,isSuccess:n,isError:I,hasNextPage:k,fetchNextPage:f}=q(["assign_project_structures",r,u],({pageParam:m})=>oe({pageSize:20,current:m,search:u,project:+r}),{enabled:!!r}),v=$({isSuccess:n,data:C!=null?C:{pages:[],pageParams:[]},key:"structures",filterFn:m=>m.total_questions<1,returnList:m=>({label:`${m.structureCode} - ${m.name}`,value:JSON.stringify(m)})}),s=m=>{c(m?["all"]:[])},x=m=>{S(m)},D=()=>{let m=[];i.includes("all")?m=["all"]:i.map(l=>{m.push(JSON.parse(l).uuid)}),p!=null&&p.value?j.mutate({project_id:+r,question_template_id:p==null?void 0:p.value,structure_ids:m},{onSuccess:l=>{g({status:"success",description:l.message,position:"top",title:"Success",isClosable:!0}),b.invalidateQueries(["project_structures"]),d(T())},onError:l=>O(l,g)}):g({status:"warning",description:"Wajib pilih template",position:"top",title:"Validasi",isClosable:!0})};return t(P,{p:5,children:[t(h,{flexDirection:"column",gap:5,children:[e(Pr,{placeholder:"-- Pilih Template --",value:p,onChange:x}),e(X,{onChange:m=>{m.preventDefault(),o(m.target.value)}}),e(ue,{value:"all",onChange:m=>s(m.target.checked),children:"Semua"}),i&&i.length>0&&!i.includes("all")&&e(P,{children:t(h,{gap:3,alignItems:"center",children:[t(_,{fontSize:"sm",children:["Terpilih ",i.length," Unit "]}),e(E,{variant:"link",colorScheme:"red",size:"sm",onClick:()=>c([]),children:"Hapus Pilihan"})]})}),t(P,{maxH:500,overflowY:"auto",children:[y&&e(De,{w:"100%",h:20}),I&&e(_,{children:"Error"}),n&&!i.includes("all")&&e(Ue,{options:v,direction:"column",value:i,disabled:i.includes("all"),onChange:c})]}),k&&e(h,{justifyContent:"center",w:"100%",children:e(E,{size:"sm",onClick:()=>f(),children:"Load More"})})]}),e(ee,{children:e(E,{variant:"solid",onClick:D,isLoading:j.isLoading,children:"Simpan"})})]})},fe=({...r})=>t(be,{...r,children:[e("path",{d:"M2 14L5.23309 16.4248C5.66178 16.7463 6.26772 16.6728 6.60705 16.2581L15 6",stroke:"currentColor",strokeWidth:"2",fill:"transparent",strokeLinecap:"round"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.87451 15.7801L11.6031 17.163C12.4589 17.8477 13.7064 17.716 14.4004 16.8677L22.7741 6.63324C23.1238 6.20579 23.0608 5.57577 22.6333 5.22604C22.2059 4.87631 21.5759 4.93932 21.2262 5.36676L12.8525 15.6013L11.1411 14.2321L9.87451 15.7801Z",fill:"currentColor"})]}),kr=({projectId:r,active:a,onClick:o})=>{const[i,c]=L.exports.useState(null),{colorMode:p}=Fe(),S=F(),g=V(i,100),{data:d,isLoading:u,isSuccess:j,isError:b}=J(["project_structures",r,g],()=>oe({pageSize:100,current:1,search:g,project:+r}),{enabled:!!r}),C=L.exports.useCallback((n,I=0)=>{var k,f,v;return(n==null?void 0:n.children)&&((k=n==null?void 0:n.children)==null?void 0:k.length)>0?t(P,{position:"relative",children:[e(N,{label:n.name,children:t(h,{py:1,px:2,my:2,cursor:"pointer",justifyContent:"space-between",borderRadius:15,alignItems:"center",_hover:{backgroundColor:"rgba(104,211,145,0.35)"},backgroundColor:a===n.uuid?"rgba(104,211,145,0.35)":"none",onClick:()=>{o(n.uuid)},children:[t(_,{noOfLines:[1],children:[n.structureCode," - ",n.name]}),e(fe,{color:n.total_questions>0&&"brand.light"})]})}),e(P,{sx:{ml:5},children:(f=n==null?void 0:n.children)==null?void 0:f.map(s=>C(s,I+1))}),e(P,{width:.5,height:`calc(100% - ${((v=n==null?void 0:n.children)==null?void 0:v.length)+38}px)`,bg:p==="light"?"black":"white",position:"absolute",left:3,top:9})]}):e(N,{label:n.name,children:t(h,{py:1,my:2,px:2,_hover:{backgroundColor:"rgba(104,211,145,0.35)"},backgroundColor:a===n.uuid?"rgba(104,211,145,0.35)":"none",cursor:"pointer",onClick:()=>o(n.uuid),gap:5,alignItems:"center",borderRadius:15,children:[t(_,{noOfLines:[1],children:[n.structureCode," - ",n.name]}),e(fe,{color:n.total_questions>0&&"brand.light"})]})})},[a,p]);return t(le,{children:[t(ce,{children:[t(h,{justifyContent:"space-between",alignItems:"center",children:[e(_,{fontWeight:"medium",fontSize:19,children:"Unit Kerja"}),e(N,{label:"Atur Template",children:e(U,{"aria-label":"Add Questioner",onClick:()=>{S(Q(e(yr,{projectId:r}),"Atur Template Pertanyaan per Unit kerja","lg"))},icon:e(ve,{}),variant:"outline",border:"none"})})]}),e("small",{children:"Centang dua hijau : sudah diatur pertanyaan"})]}),t(de,{children:[e(X,{onChange:n=>{n.preventDefault(),c(n.target.value)}}),t(P,{mt:3,children:[b&&e(Le,{}),u&&"Loading...",j&&(d==null?void 0:d.structures)&&(d==null?void 0:d.structures.length)>0?g===""||!g?Me("uuid","parent_id",d==null?void 0:d.structures).map(n=>C(n,0)):d==null?void 0:d.structures.map(n=>C(n,0)):e(B,{})]})]})]})},xr=({initialValues:r={project_description:null,project_name:null,project_status:null,project_code:null,project_type:null,project_due_date:null},isLoading:a=!1,onSubmit:o})=>{const i=F();return t(ae,{initialValues:r,onSubmit:o,id:"form-project-info",children:[e(P,{p:5,children:e(He,{disabled:{project_type:!0}})}),e(ee,{children:t(h,{alignItems:"center",gap:5,children:[e(E,{variant:"outline",colorScheme:"red",size:"sm",onClick:()=>i(T()),children:"Cancel"}),e(E,{type:"submit",variant:"solid",isLoading:a,size:"sm",leftIcon:e(Ae,{}),children:"Submit"})]})})]})},Ir=({projectId:r})=>{const[a,o]=L.exports.useState(),[i,c]=L.exports.useState([]),p=H(),S=Z(),g=F(),d=V(a,200),u=R(er),{data:j,isLoading:b,isSuccess:C,isError:y,hasNextPage:n,fetchNextPage:I}=q(["assign_users",d,r],({pageParam:s})=>rr({pageSize:20,current:s,search:d,project_id:r})),k=$({isSuccess:C,data:j!=null?j:{pages:[],pageParams:[]},key:"users",filterFn:s=>s.roleId!==1,returnList:s=>{var x,D;return{label:t(h,{gap:2,alignItems:"center",children:[e(re,{size:"xs",objectFit:"cover",name:(x=s.full_name)!=null?x:"",src:s.profile_pict?`/api/v1/profiles/${s.profile_pict}`:"/default-image.jpg"}),e(_,{fontSize:"sm",children:(D=s.full_name)!=null?D:""})]}),value:JSON.stringify(s)}}}),f=s=>{c(s?["all"]:[])};return t(ae,{onSubmit:s=>{const x=s.job.map(l=>l.value),D=s.unit_kerja.map(l=>l.value);let m=[];i.includes("all")?m=["all"]:i.map(l=>{m.push(String(JSON.parse(l).id))}),u.mutate({project_id:+r,job:x,structure_id:D,users:m},{onSuccess:l=>{p({status:"success",title:"success",description:l.message,position:"top",isClosable:!0}),S.invalidateQueries(["project_detail"]),S.invalidateQueries(["users_assigned"]),g(T())},onError:l=>O(l,p)})},id:"form-assign",children:[e(P,{p:5,children:t(h,{flexDirection:"column",gap:5,children:[e(Ee,{project_id:r}),e(X,{onChange:s=>{s.preventDefault(),o(s.target.value)}}),e(ue,{value:"all",onChange:s=>f(s.target.checked),children:"Semua"}),i&&i.length>0&&!i.includes("all")&&e(M,{children:e(P,{children:t(h,{gap:3,alignItems:"center",children:[t(_,{fontSize:"sm",children:["Terpilih ",i.length," User "]}),e(E,{variant:"link",colorScheme:"red",size:"sm",onClick:()=>c([]),children:"Hapus Pilihan"})]})})}),t(P,{maxH:500,overflowY:"auto",children:[b&&e(De,{w:"100%",h:20}),y&&e(_,{children:"Error"}),C&&!i.includes("all")&&e(Ue,{options:k,direction:"column",value:i,disabled:i.includes("all"),onChange:c})]}),n&&e(h,{justifyContent:"center",w:"100%",children:e(E,{size:"sm",onClick:()=>I(),isLoading:b,children:"Load More"})})]})}),e(ee,{children:e(E,{type:"submit",isLoading:u.isLoading,children:"Simpan"})})]})},Ar=L.exports.lazy(()=>we(()=>import("./Questionaire.9f2a0601.js"),["assets/Questionaire.9f2a0601.js","assets/index.5b816863.js","assets/index.65707869.css","assets/PagePadding.45875137.js","assets/Detailinformation.a10fd27e.js","assets/CommentsIcon.3085cb31.js","assets/FileIcon.24dbe717.js","assets/dayjs.min.8382c62a.js","assets/relativeTime.3d17f6ee.js","assets/index.esm.70bdc104.js","assets/index.esm.089565e5.js","assets/slicedToArray.01f71b8b.js","assets/index.esm.f21969b8.js","assets/EditIcon.22244ff4.js","assets/FormFieldControl.83524802.js","assets/index.esm.9250e631.js","assets/index.238261e4.js","assets/FieldTextArea.7018b180.js","assets/index.esm.1375edc3.js","assets/FieldText.51c97a45.js","assets/FieldCustom.e664487c.js","assets/useGetPrevPageParam.cb1386c2.js","assets/useDebounce.b2496c93.js","assets/useSelectDataMapper.1d7decc0.js","assets/usersActions.cd3a8c1d.js","assets/select.c640a523.js","assets/objectWithoutPropertiesLoose.2d2ba74a.js","assets/index.esm.7f1cbbdf.js","assets/index.esm.28b35340.js","assets/projectActions.1197d90c.js","assets/FilterIcon.05aa0837.js","assets/ErrorFetching.2a6dc88b.js","assets/useTranslation.6be11027.js","assets/useError.d999dd2c.js","assets/ArrowLeftIcon.5e09b122.js","assets/questionActions.98bb3067.js","assets/ErrorEmpty.180e4712.js","assets/uiActions.07096468.js","assets/index.esm.5601fbef.js","assets/inheritsLoose.ae32a3c5.js","assets/index.esm.c26f097d.js"])),Pt=()=>{const{id:r}=Ne(),a=H(),o=F(),i=je(),[c,p]=L.exports.useState(null),S=L.exports.useRef(null),g=R(tr),d=R(nr),{data:u,isLoading:j,isSuccess:b,isError:C,refetch:y}=J(["project_detail",r],()=>ir(+r),{enabled:!!r}),{data:n,isSuccess:I}=J(["users_assigned",r],()=>gr(r),{enabled:!!r}),k=l=>{d.mutate(l,{onSuccess:z=>{a({status:"success",title:"Success",isClosable:!0,description:z.message,position:"top"}),o(T()),i("/activity/projects")},onError:z=>O(z,a)})},f=l=>{o(Q(e(ye,{onDelete:()=>k(l)}),"Apakah kamu yakin ingin menghapus project ini ?","sm"))},v=l=>{g.mutate({id:r,payload:{project_code:l.project_code,project_description:l.project_description,project_due_date:l.project_due_date,project_name:l.project_name,project_status:l.project_status.value,project_type:l.project_type.value}},{onSuccess:z=>{a({status:"success",title:"Success",description:z.message,position:"top",isClosable:!0}),o(T()),y()},onError:z=>O(z,a)})},s=()=>{o(Q(e(xr,{onSubmit:v,isLoading:g.isLoading,initialValues:{project_description:u.data.description,project_name:u.data.name,project_status:{label:u.data.select_status_label,value:u.data.status},project_code:u.data.project_code,project_type:{label:u.data.select_project_type_label,value:u.data.type},project_due_date:new Date(u.data.project_date)}}),"Edit Project","lg"))},x=l=>{var z;p(l),(z=S.current)==null||z.removeFilterQuestions()},D=()=>{o(Q(e(Ir,{projectId:r}),"Atur User per Unit Kerja","md"))},m=()=>{o(Pe({component:e(ze,{project_id:r}),title:"List Assigned User",size:"md"}))};return t(Oe,{title:"Detail Projek ",children:[j&&e(pe,{}),b&&t(M,{children:[e(Re,{label:u.data.name,size:{base:"xs",sm:"md",md:"lg"},useBackButton:!0,additional:t(h,{alignItems:"center",gap:2,children:[e(me,{variant:"subtle",colorScheme:"blue",children:u.data.type}),e(me,{variant:"subtle",colorScheme:"green",children:u.data.status})]})}),t(Qe,{x:6,children:[t(K,{templateColumns:{base:"repeat(1,1fr)",md:"repeat(2,1fr)"},gap:5,mb:5,children:[e(A,{children:e(vr,{data:u.data,onEdit:s,onDelete:()=>f(+r)})}),e(A,{children:e(_r,{})})]}),t(K,{templateColumns:"repeat(6,1fr)",gap:5,children:[e(A,{colSpan:{base:6,lg:6,xl:2},children:e(kr,{projectId:r,onClick:l=>x(l),active:c})}),t(A,{colSpan:{base:6,lg:6,xl:4},children:[t(h,{alignItems:"center",gap:2,children:[e(_,{fontWeight:"semibold",children:"Assigned User"}),e(U,{"aria-label":"Add Assigned User",fontSize:26,onClick:D,variant:"outline",borderRadius:50,icon:e(ve,{})}),I&&e(M,{children:n.data&&n.data.length>0&&t(M,{children:[e(or,{size:"md",max:2,children:n.data.map(l=>e(re,{name:l.full_name,src:l.profile_pict?`/api/v1/profiles/${l.profile_pict}`:"/default-image.jpg"}))}),e(N,{label:"Edit Assigned Users",children:e(U,{"aria-label":"Edit Assigned User",fontSize:26,color:"yellow.500",variant:"link",onClick:m,icon:e(se,{})})})]})})]}),t(fr,{children:[t(br,{overflowX:"auto",overflowY:"hidden",children:[e(G,{children:"Questioner"}),e(G,{children:"Inventory"}),e(G,{children:"Volume"}),e(G,{children:"Log Activity"})]}),t(Sr,{children:[e(W,{p:0,children:c?e(L.exports.Suspense,{fallback:e(pe,{}),children:e(Ar,{ref:S,structuresId:c,projectId:+r,editable:!0})}):e(B,{})}),e(W,{children:e(B,{})}),e(W,{children:e(B,{})}),e(W,{children:e(B,{})})]})]})]})]})]})]}),C&&e(Le,{})]})};export{Pt as default};
