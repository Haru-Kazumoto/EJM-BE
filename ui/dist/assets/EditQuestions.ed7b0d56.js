import{e as I,a2 as M,aa as k,a as e,j as d,r as D,aR as j,c as U,f as Q,R as $,ah as q,F as K,g as H,h as V}from"./index.990a5e8d.js";import{a as W}from"./PagePadding.be31ae21.js";import{P as Y}from"./PageHeader.6ac11668.js";import{h as G,i as J,b as O,j as R}from"./questionActions.3af83eea.js";import{u as N,E as f}from"./useError.dd598f5e.js";import{E as X}from"./ErrorFetching.fd4f3ed6.js";import{E as S}from"./EditIcon.b6b72d62.js";import{c as T,o as F}from"./uiActions.4e6bb8aa.js";import{B as Z}from"./BeTable.63ce5081.js";import{D as w}from"./DeleteIcon.d5ab39ed.js";import{a as ee,F as ae}from"./FormFieldControl.8ea8ed9e.js";import{F as te}from"./FieldText.f2654eae.js";import{f as ie,e as oe}from"./index.esm.84445d7f.js";import{B as c,I as ne}from"./index.esm.27876472.js";import{A as se}from"./AddIcon.c6d76087.js";import{U as re}from"./useTableHelper.8cdf755a.js";import{C as me}from"./ConfirmDelete.4fd5f463.js";import{T as le}from"./index.esm.3c7789c6.js";import"./ArrowLeftIcon.e64cc763.js";import"./useTranslation.0fd06a78.js";import"./slicedToArray.925b8532.js";import"./index.esm.3fa18c93.js";import"./index.esm.c75d359e.js";import"./FilterIcon.57294db7.js";import"./index.esm.5f476ef3.js";import"./index.esm.86199dec.js";import"./index.238261e4.js";import"./ErrorEmpty.a2e6d48b.js";import"./Pagination.29c8658c.js";import"./ExpandLeftIcon.bf57eb47.js";import"./ExpandRightIcon.3b8cbe09.js";import"./SearchInput.fe556bc9.js";import"./useDebounce.51d664ab.js";import"./objectWithoutPropertiesLoose.2d2ba74a.js";import"./inheritsLoose.72c0b9db.js";const de=({name:i,id:l})=>{const r=I(),m=M(),u=k(),p=N(G);return e(ee,{onSubmit:n=>{p.mutate({id:l,name:n.template_name},{onSuccess:s=>{m({status:"success",title:"success",description:s.message,isClosable:!0,position:"top"}),u.invalidateQueries(["detail_template"]),r(T())},onError:s=>f(s,m)})},id:"form-edit-question",initialValues:{template_name:i},children:({control:n,formState:s})=>d(D.exports.Fragment,{children:[e(ie,{children:e(ae,{control:n,formState:s,label:"Nama Template",id:"template_name",name:"template_name",rules:{required:{value:!0,message:"Dibutuhkan"}},children:e(te,{})})}),d(oe,{children:[e(c,{onClick:()=>r(T()),size:"sm",variant:"ghost",mr:3,children:"Cancel"}),e(c,{size:"sm",type:"submit",isLoading:p.isLoading,children:"Simpan"})]})]})})},Ge=()=>{var b,E,C;const{id:i}=j(),l=M(),r=I(),m=U(),u=k(),{setPagination:p,searchValue:h,pagination:n,handleSearch:s}=re(),P=N(J),{data:y,isLoading:v,isSuccess:g,isError:_}=Q(["detail_template",i],()=>O(+i),{onError:a=>{f(a,l),m("/master/setup-questions")},enabled:!!i,cacheTime:0,keepPreviousData:!1}),{data:t,isLoading:x}=Q(["questions",{searchValue:h,id:i,...n}],()=>R({pageSize:n.pageSize,current:n.pageIndex+1,search:h,template_id:+i}),{enabled:!!i,keepPreviousData:!1}),z=({name:a,id:o})=>{r(F(e(de,{id:o,name:a}),"Edit Question Template","md"))},B=a=>{P.mutate(a,{onSuccess:o=>{l({status:"success",title:"Success",position:"top",isClosable:!0,description:o.message}),u.invalidateQueries(["questions"]),r(T())},onError:o=>f(o,l)})},A=a=>{r(F(e(me,{onDelete:()=>B(a)}),"Apakah kamu yakin ingin menghapus pertanyaan ini ?","sm"))},L=$.useMemo(()=>[{id:"No",width:"auto",header:"No",accessorFn:(a,o)=>o+1},{id:"Nama Pertanyaan",header:"Nama Pertanyaan",accessorKey:"name"},{id:"Mandatory",header:"Mandatory",accessorKey:"isMandatory",cell:({row:a})=>e(q,{variant:"solid",colorScheme:a.original.isMandatory?"red":"yellow",children:a.original.isMandatory?"Ya":"Tidak"})},{id:"Action",header:"Action",cell:({row:a})=>e(D.exports.Fragment,{children:d(K,{gap:2,alignItems:"center",children:[e(c,{size:"sm",leftIcon:e(S,{}),variant:"outline",onClick:()=>m(`/question/edit/${a.original.id}?template_id=${i}`),children:"Edit"}),e(c,{size:"sm",onClick:()=>A(a.original.id),leftIcon:e(w,{}),colorScheme:"red",children:"Delete"})]})})}],[]);return d(W,{title:"Edit Question Template",children:[v&&e(H,{}),g&&d(V,{children:[e(Y,{label:`Edit Question Template "${g?y.data.name:"-"}"`,useBackButton:!0,additional:e(le,{label:"Edit Template",children:e(ne,{"aria-label":"Edit",onClick:()=>z({name:g?y.data.name:null,id:i}),variant:"unstyled",icon:e(S,{fontSize:28,color:"yellow.400"})})})}),e(Z,{data:(t==null?void 0:t.questions)||[],loading:x,columns:L,onSearch:s,rowKey:(a,o,ce)=>a==null?void 0:a.id,onChangeTable:p,pagination:{pageIndex:Number((b=t==null?void 0:t.page)!=null?b:0)-1,pageSize:Number((E=t==null?void 0:t.page_size)!=null?E:10)},pageCount:Number((C=t==null?void 0:t.page_count)!=null?C:0),totalRecords:t==null?void 0:t.total,useSearchInput:!0,rightFilter:e(c,{size:"sm",rightIcon:e(se,{}),onClick:()=>m(`/question/add?template_id=${i}`),children:"Tambah Pertanyaan"})})]}),_&&e(X,{})]})};export{Ge as default};
